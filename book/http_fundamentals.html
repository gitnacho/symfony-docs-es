
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Symfony2 y fundamentos HTTP &mdash; Manual de Symfony2 en Español</title>
    
    <link rel="stylesheet" href="../_static/tnp.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.0.13',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <link rel="shortcut icon" href="../_static/icotnp.ico"/>
    <link rel="top" title="Manual de Symfony2 en Español" href="../index.html" />
    <link rel="up" title="Libro" href="index.html" />
    <link rel="next" title="Symfony2 frente a PHP simple" href="from_flat_php_to_symfony2.html" />
    <link rel="prev" title="Libro" href="index.html" /> 
  </head>
  <body>
  <div class="imalogo">
    
  <a href="../index.html"><img src="http://gitnacho.github.com/tnp/img/sf/logo-big.gif" alt="Edición estándar de Symfony2" />
  
    <a href="http://gitnacho.github.com/tnp/"><img src="http://gitnacho.github.com/tnp/_static/normaltnp.png" alt="Traducciones de Nacho Pacheco" /></a>
    <div class="social">
      <a href="https://twitter.com/share" class="twitter-share-button" data-via="esymfony" data-lang="es">Tweet</a>
      <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
    </div>
    <div id="searchbox">
      <form class="searc " action="../search.html" method="get">
      <input type="search" name="q" placeholder="Término a buscar" />
      <input type="submit" value="Ir" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <script type="text/javascript">$('#searchbox').show(0);</script>
    </div>
    

    
    <div class="related">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Índice General"
             accesskey="I">índice</a></li>
        <li class="right" >
          <a href="from_flat_php_to_symfony2.html" title="Symfony2 frente a PHP simple"
             accesskey="N">siguiente</a> |</li>
        <li class="right" >
          <a href="index.html" title="Libro"
             accesskey="P">anterior</a> |</li>
        <li><a href="../index.html">en Español</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Libro</a> &raquo;</li> 
      </ul>
    </div>
  </div>


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="symfony2-y-fundamentos-http">
<span id="index-0"></span><h1><em>Symfony2</em> y fundamentos <em>HTTP</em><a class="headerlink" href="#symfony2-y-fundamentos-http" title="Enlazar permanentemente con este título">¶</a></h1>
<p>¡Enhorabuena! Al aprender acerca de <em>Symfony2</em>, vas bien en tu camino para llegar a ser un más <em>productivo</em>, bien <em>enfocado</em> y <em>popular</em> desarrollador web (en realidad, en la última parte, estás por tu cuenta). <em>Symfony2</em> está diseñado para volver a lo básico: las herramientas de desarrollo que te permiten desarrollar más rápido y construir aplicaciones más robustas, mientras que permanece fuera de tu camino. <em>Symfony</em> está basado en las mejores ideas de muchas tecnologías: las herramientas y conceptos que estás a punto de aprender representan el esfuerzo de miles de personas, durante muchos años. En otras palabras, no estás aprendiendo <em>&#8220;Symfony&#8221;</em>, estás aprendiendo los fundamentos de la <em>web</em>, buenas prácticas de desarrollo, y cómo utilizar muchas nuevas y asombrosas bibliotecas <em>PHP</em>, dentro o independientemente de <em>Symfony2</em>. Por lo tanto, ¡prepárate!</p>
<p>Fiel a la filosofía <em>Symfony2</em>, este capítulo comienza explicando el concepto fundamental común para el desarrollo <em>web</em>: <em>HTTP</em>. Independientemente de tus antecedentes o lenguaje de programación preferido, este capítulo es una <strong>lectura obligada</strong> para todo mundo.</p>
<div class="section" id="http-es-simple">
<h2><em>HTTP</em> es Simple<a class="headerlink" href="#http-es-simple" title="Enlazar permanentemente con este título">¶</a></h2>
<p><em>HTTP</em> (&#8220;HyperText Transfer Protocol&#8221; para los apasionados y, en Español <em>Protocolo de transferencia hipertexto</em>) es un lenguaje de texto que permite a dos máquinas comunicarse entre sí. ¡Eso es todo! Por ejemplo, al comprobar las últimas noticias acerca de cómica <a class="reference external" href="http://xkcd.com/">xkcd</a>, la siguiente conversación (aproximadamente) se lleva a cabo:</p>
<img alt="../_images/http-xkcd_es.png" class="align-center" src="../_images/http-xkcd_es.png" />
<p>Y aunque el lenguaje real utilizado es un poco más formal, sigue siendo bastante simple.
<em>HTTP</em> es el término utilizado para describir este lenguaje simple basado en texto. Y no importa cómo desarrolles en la web, el objetivo de tu servidor <em>siempre</em> es entender las peticiones de texto simple, y devolver respuestas en texto simple.</p>
<p><em>Symfony2</em> está construido basado en torno a esa realidad. Ya sea que te des cuenta o no, <em>HTTP</em> es algo que usas todos los días. Con <em>Symfony2</em>, aprenderás a dominarlo.</p>
<div class="section" id="paso-1-el-cliente-envia-una-peticion">
<span id="index-1"></span><h3>Paso 1: El cliente envía una petición<a class="headerlink" href="#paso-1-el-cliente-envia-una-peticion" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Todas las conversaciones en la web comienzan con una <em>petición</em>. La petición es un mensaje de texto creado por un cliente (por ejemplo un navegador, una aplicación para el <em>iPhone</em>, etc.) en un formato especial conocido como <em>HTTP</em>. El cliente envía la petición a un servidor, y luego espera la respuesta.</p>
<p>Echa un vistazo a la primera parte de la interacción (la petición) entre un navegador y el servidor web <cite>xkcd</cite>:</p>
<img alt="../_images/http-xkcd-request_es.png" class="align-center" src="../_images/http-xkcd-request_es.png" />
<p>Hablando en <em>HTTP</em>, esta petición <em>HTTP</em> en realidad se vería algo parecida a esto:</p>
<div class="highlight-text"><div class="highlight"><pre>GET / HTTP/1.1
Host: xkcd.com
Accept: text/html
User-Agent: Mozilla/5.0 (Macintosh)
</pre></div>
</div>
<p>Este sencillo mensaje comunica <em>todo</em> lo necesario sobre qué recursos exactamente solicita el cliente. La primera línea de una petición <em>HTTP</em> es la más importante y contiene dos cosas: la <em>URI</em> y el método <em>HTTP</em>.</p>
<p>La <em>URI</em> (por ejemplo, <tt class="docutils literal"><span class="pre">/</span></tt>, <tt class="docutils literal"><span class="pre">/contact</span></tt>, etc.) es la dirección o ubicación que identifica unívocamente al recurso que el cliente quiere. El método <em>HTTP</em> (por ejemplo, <em>GET</em>) define lo que quieres <em>hacer</em> con el recurso. Los métodos <em>HTTP</em> son los <em>verbos</em> de la petición y definen las pocas formas más comunes en que puedes actuar sobre el recurso:</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><em>GET</em></td>
<td>Recupera el recurso desde el servidor</td>
</tr>
<tr class="row-even"><td><em>POST</em></td>
<td>Crea un recurso en el servidor</td>
</tr>
<tr class="row-odd"><td><em>PUT</em></td>
<td>Actualiza el recurso en el servidor</td>
</tr>
<tr class="row-even"><td><em>DELETE</em></td>
<td>Elimina el recurso del servidor</td>
</tr>
</tbody>
</table>
<p>Con esto en mente, te puedes imaginar que una petición <em>HTTP</em> podría ser similar a eliminar una entrada de <em>blog</em> específica, por ejemplo:</p>
<div class="highlight-text"><div class="highlight"><pre>DELETE /blog/15 HTTP/1.1
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Nota</p>
<p class="last">En realidad, hay nueve métodos <em>HTTP</em> definidos por la especificación <em>HTTP</em>, pero muchos de ellos no se utilizan o apoyan ampliamente. En realidad, muchos navegadores modernos no apoyan los métodos <em>PUT</em> y <em>DELETE</em>.</p>
</div>
<p>Además de la primera línea, una petición <em>HTTP</em> invariablemente contiene otras líneas de información conocidas como cabeceras de petición. Las cabeceras pueden suministrar una amplia gama de información como el servidor (o <tt class="docutils literal"><span class="pre">host</span></tt>) solicitado, los formatos de respuesta que acepta el cliente (<tt class="docutils literal"><span class="pre">Accept</span></tt>) y la aplicación que utiliza el cliente para realizar la petición (<tt class="docutils literal"><span class="pre">User-Agent</span></tt>). Existen muchas otras cabeceras y se pueden encontrar en el artículo <a class="reference external" href="http://en.wikipedia.org/wiki/List_of_HTTP_header_fields">Lista de campos de las cabeceras HTTP</a> en la Wikipedia.</p>
</div>
<div class="section" id="paso-2-el-servidor-devuelve-una-respuesta">
<h3>Paso 2: El servidor devuelve una respuesta<a class="headerlink" href="#paso-2-el-servidor-devuelve-una-respuesta" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Una vez que un servidor ha recibido la petición, sabe exactamente qué recursos necesita el cliente (a través de la <em>URI</em>) y lo que el cliente quiere hacer con ese recurso (a través del método). Por ejemplo, en el caso de una petición <em>GET</em>, el servidor prepara el recurso y lo devuelve en una respuesta <em>HTTP</em>. Considera la respuesta del servidor web, xkcd:</p>
<img alt="../_images/http-xkcd_es.png" class="align-center" src="../_images/http-xkcd_es.png" />
<p>Traducida a <em>HTTP</em>, la respuesta enviada de vuelta al navegador se verá algo similar a esto:</p>
<div class="highlight-text"><div class="highlight"><pre>HTTP/1.1 200 OK
Date: Sat, 02 Apr 2011 21:05:05 GMT
Server: lighttpd/1.4.19
Content-Type: text/html

    &lt;html&gt;
  &lt;!-- HTML for the xkcd comic --&gt;
    &lt;/html&gt;
</pre></div>
</div>
<p>La respuesta <em>HTTP</em> contiene el recurso solicitado (contenido <em>HTML</em> en este caso), así como otra información acerca de la respuesta. La primera línea es especialmente importante y contiene el código de estado <em>HTTP</em> (200 en este caso) de la respuesta. El código de estado comunica el resultado global de la petición devuelta al cliente. ¿Tuvo éxito la petición? ¿Hubo algún error? Existen diferentes códigos de estado que indican éxito, un error o qué más se necesita hacer con el cliente (por ejemplo, redirigirlo a otra página). La lista completa se puede encontrar en el artículo <a class="reference external" href="http://en.wikipedia.org/wiki/List_of_HTTP_status_codes">Lista de códigos de estado HTTP</a> en la Wikipedia.</p>
<p>Al igual que la petición, una respuesta <em>HTTP</em> contiene datos adicionales conocidos como cabeceras <em>HTTP</em>. Por ejemplo, una importante cabecera de la respuesta <em>HTTP</em> es <tt class="docutils literal"><span class="pre">Content-Type</span></tt>. El cuerpo del mismo recurso se puede devolver en varios formatos diferentes, incluyendo <em>HTML</em>, <em>XML</em> o <em>JSON</em> y la cabecera <tt class="docutils literal"><span class="pre">Content-Type</span></tt> utiliza Internet Media Types como <tt class="docutils literal"><span class="pre">text/html</span></tt> para decirle al cliente cual formato se ha devuelto. Puedes encontrar una lista completa en el artículo <a class="reference external" href="http://en.wikipedia.org/wiki/Internet_media_type#List_of_common_media_types">Lista de medios de comunicación de Internet</a> en la Wikipedia.</p>
<p>Existen muchas otras cabeceras, algunas de las cuales son muy poderosas. Por ejemplo, ciertas cabeceras se pueden usar para crear un poderoso sistema de memoria caché.</p>
</div>
<div class="section" id="peticiones-respuestas-y-desarrollo-web">
<h3>Peticiones, respuestas y desarrollo Web<a class="headerlink" href="#peticiones-respuestas-y-desarrollo-web" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Esta conversación petición-respuesta es el proceso fundamental que impulsa toda la comunicación en la web. Y tan importante y poderoso como es este proceso, inevitablemente es simple.</p>
<p>El hecho más importante es el siguiente: independientemente del lenguaje que utilices, el tipo de aplicación que construyas (<em>web</em>, móvil, <em>API</em> <em>JSON</em>), o la filosofía de desarrollo que sigas, el objetivo final de una aplicación <strong>siempre</strong> es entender cada petición y crear y devolver la respuesta adecuada.</p>
<p><em>Symfony</em> está diseñado para adaptarse a esta realidad.</p>
<div class="admonition tip">
<p class="first admonition-title">Truco</p>
<p class="last">Para más información acerca de la especificación <em>HTTP</em>, lee la referencia original <a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616.html">HTTP 1.1 RFC</a> o <a class="reference external" href="http://datatracker.ietf.org/wg/httpbis/">HTTP Bis</a>, el cual es un esfuerzo activo para aclarar la especificación original. Una gran herramienta para comprobar tanto la petición como las cabeceras de la respuesta mientras navegas es la extensión <a class="reference external" href="https://addons.mozilla.org/en-US/firefox/addon/live-http-headers/">Cabeceras HTTP en vivo</a> (<em>Live HTTP Headers</em>) para Firefox.</p>
</div>
</div>
</div>
<div class="section" id="peticiones-y-respuestas-en-php">
<span id="index-2"></span><h2>Peticiones y respuestas en <em>PHP</em><a class="headerlink" href="#peticiones-y-respuestas-en-php" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Entonces ¿cómo interactúas con la &#8220;petición&#8221; y creas una &#8220;respuesta&#8221; utilizando <em>PHP</em>? En realidad, <em>PHP</em> te abstrae un poco de todo el proceso:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="o">&lt;?</span><span class="nx">php</span>
<span class="nv">$uri</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REQUEST_URI&#39;</span><span class="p">];</span>
<span class="nv">$foo</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;foo&#39;</span><span class="p">];</span>

<span class="nb">header</span><span class="p">(</span><span class="s1">&#39;Content-type: text/html&#39;</span><span class="p">);</span>
<span class="k">echo</span> <span class="s1">&#39;La URI solicitada es: &#39;</span><span class="o">.</span><span class="nv">$uri</span><span class="p">;</span>
<span class="k">echo</span> <span class="s1">&#39;El valor del parámetro &quot;foo&quot; es: &#39;</span><span class="o">.</span><span class="nv">$foo</span><span class="p">;</span>
</pre></div>
</div>
<p>Por extraño que parezca, esta pequeña aplicación, de hecho, está tomando información de la petición <em>HTTP</em> y la utiliza para crear una respuesta <em>HTTP</em>. En lugar de analizar el mensaje <em>HTTP</em> de la petición, <em>PHP</em> prepara variables superglobales tales como <tt class="docutils literal"><span class="pre">$_SERVER</span></tt> y <tt class="docutils literal"><span class="pre">$_GET</span></tt> que contienen toda la información de la petición. Del mismo modo, en lugar de devolver la respuesta <em>HTTP</em> con formato de texto, puedes usar la función <tt class="docutils literal"><span class="pre">header()</span></tt> para crear las cabeceras de la respuesta y simplemente imprimir el contenido real que será la porción que contiene el mensaje de la respuesta. <em>PHP</em> creará una verdadera respuesta <em>HTTP</em> y la devolverá al cliente:</p>
<div class="highlight-text"><div class="highlight"><pre>HTTP/1.1 200 OK
Date: Sat, 03 Apr 2011 02:14:33 GMT
Server: Apache/2.2.17 (Unix)
Content-Type: text/html

La URI solicitada es: /testing?foo=symfony
El valor del parámetro &quot;foo&quot; es: symfony
</pre></div>
</div>
</div>
<div class="section" id="peticiones-y-respuestas-en-symfony">
<h2>Peticiones y respuestas en <em>Symfony</em><a class="headerlink" href="#peticiones-y-respuestas-en-symfony" title="Enlazar permanentemente con este título">¶</a></h2>
<p><em>Symfony</em> ofrece una alternativa al enfoque de <em>PHP</em> a través de dos clases que te permiten interactuar con la petición <em>HTTP</em> y la respuesta de una manera más fácil.
La clase <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Request</span></tt> es una sencilla representación orientada a objetos del mensaje de la petición <em>HTTP</em>. Con ella, tienes toda la información a tu alcance:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\Request</span><span class="p">;</span>

<span class="nv">$request</span> <span class="o">=</span> <span class="nx">Request</span><span class="o">::</span><span class="na">createFromGlobals</span><span class="p">();</span>

<span class="c1">// la URI solicitada (p.e. /sobre) menos algunos parámetros de la consulta</span>
<span class="nv">$request</span><span class="o">-&gt;</span><span class="na">getPathInfo</span><span class="p">();</span>

<span class="c1">// recupera las variables GET y POST respectivamente</span>
<span class="nv">$request</span><span class="o">-&gt;</span><span class="na">query</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">);</span>
<span class="nv">$request</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;default value if bar does not exist&#39;</span><span class="p">);</span>

<span class="c1">// recupera las variables de SERVER</span>
<span class="nv">$request</span><span class="o">-&gt;</span><span class="na">server</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;HTTP_HOST&#39;</span><span class="p">);</span>

<span class="c1">// recupera una instancia del archivo subido identificado por foo</span>
<span class="nv">$request</span><span class="o">-&gt;</span><span class="na">files</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">);</span>

<span class="c1">// recupera un valor de COOKIE</span>
<span class="nv">$request</span><span class="o">-&gt;</span><span class="na">cookies</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;PHPSESSID&#39;</span><span class="p">);</span>

<span class="c1">// recupera una cabecera HTTP de la petición, normalizada, con índices en minúscula</span>
<span class="nv">$request</span><span class="o">-&gt;</span><span class="na">headers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;host&#39;</span><span class="p">);</span>
<span class="nv">$request</span><span class="o">-&gt;</span><span class="na">headers</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;content_type&#39;</span><span class="p">);</span>

<span class="nv">$request</span><span class="o">-&gt;</span><span class="na">getMethod</span><span class="p">();</span>          <span class="c1">// GET, POST, PUT, DELETE, HEAD</span>
<span class="nv">$request</span><span class="o">-&gt;</span><span class="na">getLanguages</span><span class="p">();</span>       <span class="c1">// un arreglo de idiomas aceptados por el cliente</span>
</pre></div>
</div>
<p>Como bono adicional, en el fondo la clase <tt class="docutils literal"><span class="pre">Petición</span></tt> hace un montón de trabajo del cual nunca tendrás que preocuparte. Por ejemplo, el método <tt class="docutils literal"><span class="pre">isSecure()</span></tt> comprueba <em>tres</em> diferentes valores en <em>PHP</em> que pueden indicar si el usuario está conectado a través de una conexión segura (es decir, <tt class="docutils literal"><span class="pre">https</span></tt>).</p>
<div class="sidebar">
<p class="first sidebar-title"><tt class="docutils literal"><span class="pre">ParameterBags</span></tt> y atributos de la petición</p>
<p>Como vimos anteriormente, las variables <tt class="docutils literal"><span class="pre">$_GET</span></tt> y <tt class="docutils literal"><span class="pre">$_POST</span></tt> son accesibles a través de las propiedades <tt class="docutils literal"><span class="pre">query</span></tt> y <tt class="docutils literal"><span class="pre">request</span></tt>, respectivamente. Cada uno de estos objetos es un objeto de la <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\ParameterBag</span></tt>, la cual cuenta con métodos cómo:
<a href="#id1"><span class="problematic" id="id2">:method:`Symfony\\Component\\HttpFoundation\\ParameterBag::get`</span></a>,
<a href="#id3"><span class="problematic" id="id4">:method:`Symfony\\Component\\HttpFoundation\\ParameterBag::has`</span></a>,
<a href="#id5"><span class="problematic" id="id6">:method:`Symfony\\Component\\HttpFoundation\\ParameterBag::all`</span></a> entre otros.
De hecho, todas las propiedades públicas utilizadas en el ejemplo anterior son un ejemplo del <tt class="docutils literal"><span class="pre">ParameterBag</span></tt>.</p>
<p class="last" id="book-fundamentals-attributes">La clase <tt class="docutils literal"><span class="pre">Petición</span></tt> también tiene una propiedad pública <tt class="docutils literal"><span class="pre">attributes</span></tt>, que tiene datos especiales relacionados en cómo funciona internamente la aplicación. Para la plataforma <em>Symfony2</em>, <tt class="docutils literal"><span class="pre">attibutes</span></tt> mantiene los valores devueltos por la ruta buscada, tal como <tt class="docutils literal"><span class="pre">_controller</span></tt>, <tt class="docutils literal"><span class="pre">id</span></tt> (por lo tanto si tienes un comodín <tt class="docutils literal"><span class="pre">{id}</span></tt>), e incluso el nombre de la ruta buscada (<tt class="docutils literal"><span class="pre">_route</span></tt>). La propiedad <tt class="docutils literal"><span class="pre">attributes</span></tt> existe enteramente para ser un lugar donde se pueda preparar y almacenar información del contexto específico de la petición.</p>
</div>
<p><em>Symfony</em> también proporciona una clase <tt class="docutils literal"><span class="pre">Respuesta</span></tt>: una simple representación <em>PHP</em> de un mensaje de respuesta <em>HTTP</em>. Esto permite que tu aplicación utilice una interfaz orientada a objetos para construir la respuesta que será devuelta al cliente:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\Response</span><span class="p">;</span>
<span class="nv">$response</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Response</span><span class="p">();</span>

<span class="nv">$response</span><span class="o">-&gt;</span><span class="na">setContent</span><span class="p">(</span><span class="s1">&#39;&lt;html&gt;&lt;body&gt;&lt;h1&gt;Hello world!&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;&#39;</span><span class="p">);</span>
<span class="nv">$response</span><span class="o">-&gt;</span><span class="na">setStatusCode</span><span class="p">(</span><span class="mi">200</span><span class="p">);</span>
<span class="nv">$response</span><span class="o">-&gt;</span><span class="na">headers</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">,</span> <span class="s1">&#39;text/html&#39;</span><span class="p">);</span>

<span class="c1">// imprime las cabeceras HTTP seguidas por el contenido</span>
<span class="nv">$response</span><span class="o">-&gt;</span><span class="na">send</span><span class="p">();</span>
</pre></div>
</div>
<p>Si <em>Symfony</em> no ofreciera nada más, ya tendrías un conjunto de herramientas para acceder fácilmente a la información de la petición y una interfaz orientada a objetos para crear la respuesta. Incluso, a medida que aprendas muchas de las poderosas características de <em>Symfony</em>, nunca olvides que el objetivo de tu aplicación es <em>interpretar una petición y crear la respuesta adecuada basada en la lógica de tu aplicación</em>.</p>
<div class="admonition tip">
<p class="first admonition-title">Truco</p>
<p class="last">Las clases <tt class="docutils literal"><span class="pre">Respuesta</span></tt> y <tt class="docutils literal"><span class="pre">Petición</span></tt> forman parte de un componente independiente incluido en <em>Symfony</em> llamado <tt class="docutils literal"><span class="pre">HttpFoundation</span></tt>. Este componente se puede utilizar completamente independiente de <em>Symfony</em> y también proporciona clases para manejar sesiones y subir archivos.</p>
</div>
</div>
<div class="section" id="el-viaje-desde-la-peticion-hasta-la-respuesta">
<h2>El viaje desde la petición hasta la respuesta<a class="headerlink" href="#el-viaje-desde-la-peticion-hasta-la-respuesta" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Al igual que el mismo <em>HTTP</em>, los objetos <tt class="docutils literal"><span class="pre">Petición</span></tt> y <tt class="docutils literal"><span class="pre">Respuesta</span></tt> son bastante simples.
La parte difícil de la construcción de una aplicación es escribir lo que viene en el medio.
En otras palabras, el verdadero trabajo viene al escribir el código que interpreta la información de la petición y crea la respuesta.</p>
<p>Tu aplicación probablemente hace muchas cosas, como enviar correo electrónico, manejar los formularios presentados, guardar cosas en una base de datos, reproducir las páginas <em>HTML</em> y proteger el contenido con seguridad. ¿Cómo puedes manejar todo esto y todavía mantener tu código organizado y fácil de mantener?</p>
<p><em>Symfony</em> fue creado para resolver estos problemas para que no tengas que hacerlo personalmente.</p>
<div class="section" id="el-controlador-frontal">
<h3>El controlador frontal<a class="headerlink" href="#el-controlador-frontal" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Tradicionalmente, las aplicaciones eran construidas de modo que cada &#8220;página&#8221; de un sitio tenía su propio archivo físico:</p>
<div class="highlight-text"><div class="highlight"><pre>index.php
contacto.php
blog.php
</pre></div>
</div>
<p>Hay varios problemas con este enfoque, incluyendo la falta de flexibilidad de las <em>URL</em> (¿qué pasa si quieres cambiar <tt class="file docutils literal"><span class="pre">blog.php</span></tt> a <tt class="file docutils literal"><span class="pre">noticias.php</span></tt> sin romper todos tus enlaces?) y el hecho de que cada archivo <em>debe</em> incluir manualmente un conjunto de archivos básicos para la seguridad, conexiones a base de datos y que el &#8220;aspecto&#8221; del sitio pueda permanecer constante.</p>
<p>Una mucho mejor solución es usar un <a class="reference internal" href="../glossary.html#term-controlador-frontal"><em class="xref std std-term">controlador frontal</em></a>: un solo archivo <em>PHP</em> que se encargue de todas las peticiones que llegan a tu aplicación. Por ejemplo:</p>
<table border="1" class="docutils">
<colgroup>
<col width="51%" />
<col width="49%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><tt class="file docutils literal"><span class="pre">/index.php</span></tt></td>
<td>ejecuta <tt class="file docutils literal"><span class="pre">index.php</span></tt></td>
</tr>
<tr class="row-even"><td><tt class="file docutils literal"><span class="pre">/index.php/contact</span></tt></td>
<td>ejecuta <tt class="file docutils literal"><span class="pre">index.php</span></tt></td>
</tr>
<tr class="row-odd"><td><tt class="file docutils literal"><span class="pre">/index.php/blog</span></tt></td>
<td>ejecuta <tt class="file docutils literal"><span class="pre">index.php</span></tt></td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="first admonition-title">Truco</p>
<p class="last">Usando <tt class="docutils literal"><span class="pre">mod_rewrite</span></tt> de <em>Apache</em> (o equivalente con otros servidores web), las <em>URL</em> se pueden limpiar fácilmente hasta ser sólo <tt class="docutils literal"><span class="pre">/</span></tt>, <tt class="docutils literal"><span class="pre">/contact</span></tt> y <tt class="docutils literal"><span class="pre">/blog</span></tt>.</p>
</div>
<p>Ahora, cada petición se maneja exactamente igual. En lugar de <em>URL</em> individuales ejecutando diferentes archivos <em>PHP</em>, el controlador frontal <em>siempre</em> se ejecuta, y el enrutado de diferentes <em>URL</em> a diferentes partes de tu aplicación se realiza internamente. Esto resuelve los problemas del enfoque original.
Casi todas las aplicaciones <em>web</em> modernas lo hacen &#8212;incluyendo aplicaciones como <em>WordPress</em>.</p>
</div>
<div class="section" id="mantente-organizado">
<h3>Mantente organizado<a class="headerlink" href="#mantente-organizado" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Pero dentro de tu controlador frontal, ¿cómo sabes qué página debes reproducir y cómo puedes reproducir cada una en forma sana? De una forma u otra, tendrás que comprobar la <em>URI</em> entrante y ejecutar diferentes partes de tu código en función de ese valor. Esto se puede poner feo rápidamente:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// index.php</span>

<span class="nv">$request</span> <span class="o">=</span> <span class="nx">Request</span><span class="o">::</span><span class="na">createFromGlobals</span><span class="p">();</span>
<span class="nv">$path</span> <span class="o">=</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">getPathInfo</span><span class="p">();</span> <span class="c1">// La ruta URI solicitada</span>

<span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$path</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">))</span> <span class="p">{</span>
    <span class="nv">$response</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Response</span><span class="p">(</span><span class="s1">&#39;Welcome to the homepage.&#39;</span><span class="p">);</span>
<span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="nv">$path</span> <span class="o">==</span> <span class="s1">&#39;/contact&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$response</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Response</span><span class="p">(</span><span class="s1">&#39;Contact us&#39;</span><span class="p">);</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nv">$response</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Response</span><span class="p">(</span><span class="s1">&#39;Page not found.&#39;</span><span class="p">,</span> <span class="mi">404</span><span class="p">);</span>
<span class="p">}</span>
<span class="nv">$response</span><span class="o">-&gt;</span><span class="na">send</span><span class="p">();</span>
</pre></div>
</div>
<p>La solución a este problema puede ser difícil. Afortunadamente esto es <em>exactamente</em> para lo que <em>Symfony</em> está diseñado.</p>
</div>
<div class="section" id="el-flujo-de-las-aplicaciones-symfony">
<h3>El flujo de las aplicaciones <em>Symfony</em><a class="headerlink" href="#el-flujo-de-las-aplicaciones-symfony" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Cuando dejas que <em>Symfony</em> controle cada petición, la vida es mucho más fácil. <em>Symfony</em> sigue el mismo patrón simple en cada petición:</p>
<div class="figure align-center" id="request-flow-figure">
<img alt="Flujo de la petición en Symfony2" src="../_images/request-flow_es.png" />
<p class="caption">Las peticiones entrantes son interpretadas por el enrutador y pasadas a las funciones controladoras que regresan objetos <tt class="docutils literal"><span class="pre">Respuesta</span></tt>.</p>
</div>
<p>Cada &#8220;página&#8221; de tu sitio está definida en un archivo de configuración de enrutado que asigna las diferentes <em>URL</em> a diferentes funciones <em>PHP</em>. El trabajo de cada función <em>PHP</em> conocida como <a class="reference internal" href="../glossary.html#term-controlador"><em class="xref std std-term">controlador</em></a>, es utilizar la información de la petición &#8212;junto con muchas otras herramientas que <em>Symfony</em> pone a tu disposición&#8212; para crear y devolver un objeto <tt class="docutils literal"><span class="pre">Respuesta</span></tt>. En otras palabras, el controlador es donde <em>está tu</em> código: ahí es dónde se interpreta la petición y crea una respuesta.</p>
<p>¡Así de fácil! Repasemos:</p>
<ul class="simple">
<li>Cada petición ejecuta un archivo controlador frontal;</li>
<li>El sistema de enrutado determina cual función <em>PHP</em> se debe ejecutar en base a la información de la petición y la configuración de enrutado que hemos creado;</li>
<li>La función <em>PHP</em> correcta se ejecuta, donde tu código crea y devuelve el objeto <tt class="docutils literal"><span class="pre">Respuesta</span></tt> adecuado.</li>
</ul>
</div>
<div class="section" id="una-peticion-symfony-en-accion">
<h3>Una petición <em>Symfony</em> en acción<a class="headerlink" href="#una-peticion-symfony-en-accion" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Sin bucear demasiado en los detalles, veamos este proceso en acción. Supongamos que deseas agregar una página <tt class="docutils literal"><span class="pre">/contact</span></tt> a tu aplicación <em>Symfony</em>. En primer lugar, empezamos agregando una entrada <tt class="docutils literal"><span class="pre">/contact</span></tt> a tu archivo de configuración de enrutado:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">contact</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">pattern</span><span class="p-Indicator">:</span>  <span class="l-Scalar-Plain">/contact</span>
    <span class="l-Scalar-Plain">defaults</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="nv">_controller</span><span class="p-Indicator">:</span> <span class="nv">AcmeDemoBundle</span><span class="p-Indicator">:</span><span class="nv">Main</span><span class="p-Indicator">:</span><span class="nv">contact</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Nota</p>
<p class="last">En este ejemplo utilizamos <a class="reference internal" href="../components/yaml.html"><em>YAML</em></a> para definir la configuración de enrutado. La configuración de enrutado también se puede escribir en otros formatos, tal como <em>XML</em> o <em>PHP</em>.</p>
</div>
<p>Cuando alguien visita la página <tt class="docutils literal"><span class="pre">/contact</span></tt>, esta ruta coincide, y se ejecuta el controlador especificado. Como veremos en el capítulo <a class="reference internal" href="routing.html"><em>Enrutando</em></a>, La cadena <tt class="docutils literal"><span class="pre">AcmeDemoBundle:Main:contact</span></tt> es una sintaxis corta que apunta hacia el método <em>PHP</em> <tt class="docutils literal"><span class="pre">contactAction</span></tt> dentro de una clase llamada <tt class="docutils literal"><span class="pre">MainController</span></tt>:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MainController</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">contactAction</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">Response</span><span class="p">(</span><span class="s1">&#39;&lt;h1&gt;Contact us!&lt;/h1&gt;&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>En este ejemplo muy simple, el controlador simplemente crea un objeto <tt class="docutils literal"><span class="pre">Respuesta</span></tt> con el código <em>HTML</em> <tt class="docutils literal"><span class="pre">&quot;&lt;h1&gt;Contact</span> <span class="pre">us!&lt;/h1&gt;&quot;</span></tt>. En el capítulo <a class="reference internal" href="controller.html"><em>Controlador</em></a>, aprenderás cómo un controlador puede reproducir plantillas, permitiendo que tu código de &#8220;presentación&#8221; (es decir, algo que en realidad escribe <em>HTML</em>) viva en un archivo de plantilla separado. Esto libera al controlador de preocuparse sólo de las cosas difíciles: la interacción con la base de datos, la manipulación de los datos presentados o el envío de mensajes de correo electrónico.</p>
</div>
</div>
<div class="section" id="symfony2-construye-tu-aplicacion-no-tus-herramientas">
<h2><em>Symfony2</em>: Construye tu aplicación, no tus herramientas.<a class="headerlink" href="#symfony2-construye-tu-aplicacion-no-tus-herramientas" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Ahora sabemos que el objetivo de cualquier aplicación es interpretar cada petición entrante y crear una respuesta adecuada. Cuando una aplicación crece, es más difícil mantener organizado tu código y que a la vez sea fácil darle mantenimiento. Invariablemente, las mismas tareas complejas siguen viniendo una y otra vez: la persistencia de cosas a la base de datos, procesamiento y reutilización de plantillas, manejo de formularios presentados, envío de mensajes de correo electrónico, validación de entradas del usuario y administración de la seguridad.</p>
<p>La buena nueva es que ninguno de estos problemas es único. <em>Symfony</em> proporciona una plataforma completa, con herramientas que te permiten construir tu aplicación, no tus herramientas. Con <em>Symfony2</em>, nada se te impone: eres libre de usar la plataforma <em>Symfony</em> completa, o simplemente una pieza de <em>Symfony</em> por sí misma.</p>
<div class="section" id="herramientas-independientes-componentes-de-symfony2">
<span id="index-3"></span><h3>Herramientas independientes: <em>Componentes</em> de <em>Symfony2</em><a class="headerlink" href="#herramientas-independientes-componentes-de-symfony2" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Entonces, ¿qué <em>es Symfony2</em>? En primer lugar, <em>Symfony2</em> es una colección de más de veinte bibliotecas independientes que se pueden utilizar dentro de <em>cualquier</em> proyecto <em>PHP</em>. Estas bibliotecas, llamadas <em>componentes de Symfony2</em>, contienen algo útil para casi cualquier situación, independientemente de cómo desarrolles tu proyecto. Para nombrar algunas:</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/symfony/HttpFoundation">HttpFoundation</a> &#8212; Contiene las clases <tt class="docutils literal"><span class="pre">Petición</span></tt> y <tt class="docutils literal"><span class="pre">Respuesta</span></tt>, así como otras clases para manejar sesiones y cargar archivos;</li>
<li><a class="reference external" href="https://github.com/symfony/Routing">Routing</a> &#8212; Potente y rápido sistema de enrutado que te permite asignar una <em>URI</em> específica (por ejemplo <tt class="docutils literal"><span class="pre">/contacto</span></tt>) a cierta información acerca de cómo se debe manejar dicha petición (por ejemplo, ejecutar el método <tt class="docutils literal"><span class="pre">contactoAction()</span></tt>);</li>
<li><a class="reference external" href="https://github.com/symfony/Form">Form</a> &#8212; Una completa y flexible plataforma para crear formularios y procesar los datos presentados en ellos;</li>
<li><a class="reference external" href="https://github.com/symfony/Validator">Validator</a> Un sistema para crear reglas sobre datos y entonces, cuando el usuario presenta los datos comprobar si son válidos o no siguiendo esas reglas;</li>
<li><a class="reference external" href="https://github.com/symfony/ClassLoader">ClassLoader</a> Una biblioteca para carga automática que te permite utilizar clases <em>PHP</em> sin necesidad de <tt class="docutils literal"><span class="pre">requerir</span></tt> manualmente los archivos que contienen esas clases;</li>
<li><a class="reference external" href="https://github.com/symfony/Templating">Templating</a> Un juego de herramientas para reproducir plantillas, la cual gestiona la herencia de plantillas (es decir, una plantilla está decorada con un diseño) y realiza otras tareas de plantilla comunes;</li>
<li><a class="reference external" href="https://github.com/symfony/Security">Security</a> &#8212; Una poderosa biblioteca para manejar todo tipo de seguridad dentro de una aplicación;</li>
<li><a class="reference external" href="https://github.com/symfony/Translation">Translation</a> Una plataforma para traducir cadenas en tu aplicación.</li>
</ul>
<p>Todos y cada uno de estos componentes se desacoplan y se pueden utilizar en <em>cualquier</em> proyecto <em>PHP</em>, independientemente de si utilizas la plataforma <em>Symfony2</em>.
Cada parte está hecha para utilizarla si es conveniente y sustituirse cuando sea necesario.</p>
</div>
<div class="section" id="la-solucion-completa-la-plataforma-symfony2">
<h3>La solución completa: La <em>plataforma Symfony2</em><a class="headerlink" href="#la-solucion-completa-la-plataforma-symfony2" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Entonces, ¿qué <em>es</em> la <em>plataforma</em> <em>Symfony2</em>? La <em>plataforma</em> <em>Symfony2</em> es una biblioteca <em>PHP</em> que realiza dos distintas tareas:</p>
<ol class="arabic simple">
<li>Proporciona una selección de componentes (es decir, los componentes <em>Symfony2</em>) y bibliotecas de terceros (por ejemplo, <tt class="docutils literal"><span class="pre">SwiftMailer</span></tt> para enviar mensajes de correo electrónico);</li>
<li>Proporciona configuración sensible y un &#8220;pegamento&#8221; que une la biblioteca con todas estas piezas.</li>
</ol>
<p>El objetivo de la plataforma es integrar muchas herramientas independientes con el fin de proporcionar una experiencia coherente al desarrollador. Incluso la propia plataforma es un paquete <em>Symfony2</em> (es decir, un complemento) que se puede configurar o sustituir completamente.</p>
<p><em>Symfony2</em> proporciona un potente conjunto de herramientas para desarrollar aplicaciones web rápidamente sin imponerse en tu aplicación. Los usuarios normales rápidamente pueden comenzar el desarrollo usando una distribución <em>Symfony2</em>, que proporciona un esqueleto del proyecto con parámetros predeterminados. Para los usuarios más avanzados, el cielo es el límite.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  <a href="https://github.com/symfony/symfony-standard"><img style="position: fixed; top: 0; right: 0; border: 0;" src="http://gitnacho.github.com/tnp/img/comun/bifurcame.png" alt="Bifúrcame en GitHub" /></a>
  
  <div style="width:740px;margin:10px auto;">
    
    <div class="related">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Índice General"
             >índice</a></li>
        <li class="right" >
          <a href="from_flat_php_to_symfony2.html" title="Symfony2 frente a PHP simple"
             >siguiente</a> |</li>
        <li class="right" >
          <a href="index.html" title="Libro"
             >anterior</a> |</li>
        <li><a href="../index.html">en Español</a> &raquo;</li>
          <li><a href="index.html" >Libro</a> &raquo;</li> 
      </ul>
    </div>
  </div>


   <div style="width: 740px; margin: 0 auto;">
     <div id="disqus_thread"></div>
     
    <div class="footer">
        &copy; Copyright 2011-2012, Traducido por Nacho Pacheco.
      Actualizado por última vez en May 07, 2012.
      Creado con <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.2.
    </div>
   </div>
   <script type="text/javascript">
    var disqus_shortname = 'documentos-mx';
    var disqus_developer = 1;
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
   </script>
   <noscript>
     Por favor activa JavaScript para ver los <a href="http://disqus.com/?ref_noscript">comentarios accionados por Disqus.</a>
   </noscript>

  </body>
</html>