
<!DOCTYPE html> 
<html lang="es">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>DoctrinePHPCRBundle &mdash; Manual de Symfony2 en Español</title>
    
    <link rel="stylesheet" href="../../_static/tnp.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '2.0.15',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/translations.js"></script>
    <link rel="shortcut icon" href="../../_static/icotnp.ico"/>
    <link rel="top" title="Manual de Symfony2 en Español" href="../../index.html" />
    <link rel="up" title="Documentación del CMF de Symfony" href="../index.html" />
    <link rel="next" title="MenuBundle" href="menu.html" />
    <link rel="prev" title="CreateBundle" href="create.html" /> 
  </head>
  <body>
  <div class="imalogo">
    
  <a href="../../index.html"><img src="http://gitnacho.github.com/tnp/img/sf/logo-big.gif" alt="Edición estándar de Symfony2" />
  
    <a href="../../index.html"><img src="http://gitnacho.github.com/tnp/_static/normaltnp.png" alt="Traducciones de Nacho Pacheco" /></a>
    <div class="social">
      <a href="https://twitter.com/share" class="twitter-share-button" data-via="esymfony" data-lang="es">Tweet</a>
      <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
    </div>
    <div id="searchbox">
      <form class="searc " action="../../search.html" method="get">
      <input type="search" name="q" placeholder="Término a buscar" />
      <input type="submit" value="Ir" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <script type="text/javascript">$('#searchbox').show(0);</script>
    </div>
    

    <div class="related">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="Índice General"
             accesskey="I">índice</a></li>
        <li class="right" >
          <a href="menu.html" title="MenuBundle"
             accesskey="N">siguiente</a> |</li>
        <li class="right" >
          <a href="create.html" title="CreateBundle"
             accesskey="P">anterior</a> |</li>
        <li><a href="../../index.html">en Español</a> &raquo;</li>
          <li><a href="../index.html" accesskey="U">Documentación del <tt class="docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal"><span class="pre">CMF</span></tt> de <em>Symfony</em></a> &raquo;</li> 
      </ul>
    </div>
  </div>


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="doctrinephpcrbundle">
<h1><tt class="docutils literal"><span class="pre">DoctrinePHPCRBundle</span></tt><a class="headerlink" href="#doctrinephpcrbundle" title="Enlazar permanentemente con este título">¶</a></h1>
<p>El <a class="reference external" href="https://github.com/doctrine/DoctrinePHPCRBundle">DoctrinePHPCRBundle</a> proporciona integración con el repositorio de contenido <em>PHP</em> y opcionalmente con el <em>PHPCR-ODM</em> de <em>Doctrine</em>
para proporcionar el gestor de documentos <em>ODM</em> en <em>Symfony</em>.</p>
<p>Fuera de la caja, este paquete apoya las siguientes implementaciones <em>PHPCR</em>:</p>
<ul class="simple">
<li><a class="reference external" href="http://jackalope.github.com/">Jackalope</a> (ambos transportes jackrabbit y doctrine-dbal)</li>
<li><a class="reference external" href="http://midgard-project.org/phpcr/">Midgard2</a></li>
</ul>
<div class="admonition tip" id="index-0">
<p class="first admonition-title">Truco</p>
<p class="last">Esta referencia sólo explica la integración de <em>Symfony2</em> con <em>PHPCR</em> y <em>PHPCR-ODM</em>. Para aprender cómo utilizar <em>PHPCR</em> ve al <a class="reference external" href="http://phpcr.github.com/">sitio web de PHPCR</a> y para la documentación del <a class="reference external" href="http://docs.doctrine-project.org/projects/doctrine-phpcr-odm/en/latest/">PHPCR-ODM</a> de <em>Doctrine</em> .</p>
</div>
<p>Este paquete está basado en el <tt class="docutils literal"><span class="pre">AbstractDoctrineBundle</span></tt> y por lo tanto es similar a la configuración de los paquetes <em>ORM</em> y <em>MongoDB</em> de <em>Doctrine</em>.</p>
<div class="section" id="configurando">
<h2>Configurando<a class="headerlink" href="#configurando" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Ve <a class="reference internal" href="../tutorials/installing-configuring-doctrine-phpcr-odm.html"><em>Instalando y configurando Doctrine y PHPCR-ODM</em></a></p>
</div>
<div class="section" id="id2">
<h2>Configurando<a class="headerlink" href="#id2" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="admonition tip">
<p class="first admonition-title">Truco</p>
<p class="last">Si sólo quieres utilizar el <em>PHPCR</em> sencillo sin el <em>PHPCR-ODM</em>, sencillamente no configures la sección <tt class="docutils literal"><span class="pre">odm</span></tt> para evitar que cargue los servicios. Ten en cuenta que muchos paquetes predefinidos del <em>CMF</em> usan documentos <em>PHPCR-ODM</em> y por ello necesitas habilitar el <em>ODM</em>.</p>
</div>
<div class="section" id="configurando-la-sesion-phpcr">
<h3>Configurando la sesión <em>PHPCR</em><a class="headerlink" href="#configurando-la-sesion-phpcr" title="Enlazar permanentemente con este título">¶</a></h3>
<p>La sesión necesita que especifiques una implementación <em>PHPCR</em> en la sección <tt class="docutils literal"><span class="pre">backend</span></tt> para el campo <tt class="docutils literal"><span class="pre">type</span></tt>, junto con opciones de configuración al arranque de la implementación. Actualmente apoyamos <tt class="docutils literal"><span class="pre">jackrabbit</span></tt>, <tt class="docutils literal"><span class="pre">doctrinedbal</span></tt> y <tt class="docutils literal"><span class="pre">midgard2</span></tt>.
Independientemente de la interfaz de administración, cada sesión <em>PHPCR</em> necesita un espacio de trabajo, nombre de usuario y contraseña.</p>
<div class="admonition tip">
<p class="first admonition-title">Truco</p>
<p class="last">Cada implementación de <em>PHPCR</em> debería proporcionar el espacio de trabajo llamado <tt class="docutils literal"><span class="pre">«default»</span></tt>, pero puedes elegir uno diferente. Existe la orden <tt class="docutils literal"><span class="pre">doctrine:phpcr:workspace:create</span></tt> para iniciar un nuevo espacio de trabajo. Ve también las <a class="reference internal" href="#reference-phpcr-commands"><em>Servicios</em></a>.</p>
</div>
<p>El nombre de usuario y contraseña que especifiques aquí son los utilizados en la capa <em>PHPCR</em> en
<tt class="docutils literal"><span class="pre">PHPCR\SimpleCredentials</span></tt>. Normalmente serán diferentes del nombre de usuario y contraseña utilizados por <em>Midgard2</em> o el <em>DBAL</em> de <em>Doctrine</em> para conectar al <em>RDBMS</em> subyacente donde de hecho se almacenan los datos.</p>
<p>Si estás utilizando una de las interfaces de administración de <tt class="docutils literal"><span class="pre">Jackalope</span></tt>, también puedes especificar <tt class="docutils literal"><span class="pre">opciones</span></tt>.
Estas serán puestas en la sesión de <tt class="docutils literal"><span class="pre">Jackalope</span></tt>. Actualmente esto se puede ajustar a nodos prerecuperados poniendo <tt class="docutils literal"><span class="pre">jackalope.fetch_depth</span></tt> a algo más grande que 0.</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># app/config/config.yml</span>
<span class="l-Scalar-Plain">doctrine_phpcr</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">session</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">backend</span><span class="p-Indicator">:</span>
            <span class="c1"># ve abajo cómo configurar la interfaz de administración que elejiste</span>
        <span class="l-Scalar-Plain">workspace</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">default</span>
        <span class="l-Scalar-Plain">username</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">admin</span>
        <span class="l-Scalar-Plain">password</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">admin</span>
        <span class="c1">## ajusta opciones para jackrabbit y doctrinedbal (todas las versiones de jackalope)</span>
        <span class="c1"># options:</span>
        <span class="c1">#    &#39;jackalope.fetch_depth&#39;: 1</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="sesion-phpcr-con-jackalope-jackrabbit">
<h4>Sesión <em>PHPCR</em> con <tt class="docutils literal"><span class="pre">Jackalope</span> <span class="pre">Jackrabbit</span></tt><a class="headerlink" href="#sesion-phpcr-con-jackalope-jackrabbit" title="Enlazar permanentemente con este título">¶</a></h4>
<p>Es la única configuración requerida para instalar el <tt class="docutils literal"><span class="pre">Jackrabbit</span></tt> de apache (ve <a class="reference internal" href="../tutorials/installing-configuring-doctrine-phpcr-odm.html#tutorials-installing-phpcr-jackrabbit"><em>instalando Jackrabbit</em></a>).</p>
<p>La configuración necesita que el parámetro <tt class="docutils literal"><span class="pre">url</span></tt> apunte a tu <tt class="docutils literal"><span class="pre">jackrabbit</span></tt>. Además puedes afinar algunas otras opciones específicas de <tt class="docutils literal"><span class="pre">jackrabbit</span></tt>, por ejemplo para utilizarlas en la configuración de una carga balanceada o para fallar temprano y aminorar el costo de algunos viajes de ida y vuelta a la interfaz de administración.</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># app/config/config.yml</span>
<span class="l-Scalar-Plain">doctrine_phpcr</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">session</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">backend</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">jackrabbit</span>
            <span class="l-Scalar-Plain">url</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">http://localhost:8080/server/</span>
            <span class="c1">## únicamente jackrabbit, opcional. ve https://github.com/jackalope/jackalope/blob/master/src/Jackalope/RepositoryFactoryJackrabbit.php</span>
            <span class="c1"># default_header: ...</span>
            <span class="c1"># expect: &#39;Esperaba: 100-continue&#39;</span>
            <span class="c1"># habilita si de cualquier manera quieres tener una excepción si</span>
            <span class="c1"># falla el incio de sesión PHPCR</span>
            <span class="c1"># check_login_on_server: false</span>
            <span class="c1"># habilita si experimentas fallos de segmentación mientras</span>
            <span class="c1"># trabajas con datos binarios en documentos</span>
            <span class="c1"># disable_stream_wrapper: true</span>
            <span class="c1"># habilita si no quieres usar transacciones y tampoco quieres</span>
            <span class="c1"># que el odm use transacciones automáticamente, es altamente</span>
            <span class="c1"># recomendable NO deshabilitar las transacciones</span>
            <span class="c1"># disable_transactions: true</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<div class="section" id="sesion-phpcr-con-el-jackalope-y-dbal-de-doctrine">
<span id="reference-phpcr-doctrinedbal"></span><h4>Sesión <em>PHPCR</em> con el <tt class="docutils literal"><span class="pre">Jackalope</span></tt> y <em>DBAL</em> de <em>Doctrine</em><a class="headerlink" href="#sesion-phpcr-con-el-jackalope-y-dbal-de-doctrine" title="Enlazar permanentemente con este título">¶</a></h4>
<p>Este tipo usa <tt class="docutils literal"><span class="pre">Jackalope</span></tt> con una abstracción en la capa de  transporte de base de datos de <em>Doctrine</em> para proporcionar <em>PHPCR</em> sin ningún requisito de instalación más allá de cualquiera de los <em>RDBMS</em> apoyados por <em>Doctrine</em>.</p>
<p>Necesitas configurar una conexión de <em>Doctrine</em> según el <em>DBAL</em> elejido en
la <a class="reference external" href="http://gitnacho.github.com/symfony-docs-es/book/doctrine.html">documentación de Doctrine en Symfony2</a>.</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># app/config/config.yml</span>
<span class="l-Scalar-Plain">doctrine_phpcr</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">session</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">backend</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">doctrinedbal</span>
            <span class="l-Scalar-Plain">connection</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">doctrine.dbal.default_connection</span>
            <span class="c1"># habilita si quieres tener una excepción inmediatamente si falla</span>
            <span class="c1"># el inicio de sesión PHPCR</span>
            <span class="c1"># check_login_on_server: false</span>
            <span class="c1"># habilita si experimentas fallos de segmentación mientras</span>
            <span class="c1"># trabajas con datos binarios en documentos</span>
            <span class="c1"># disable_stream_wrapper: true</span>
            <span class="c1"># habilita si no quieres usar transacciones y tampoco quieres</span>
            <span class="c1"># que el odm use transacciones automáticamente, es altamente</span>
            <span class="c1"># recomendable NO deshabilitar las transacciones</span>
            <span class="c1"># disable_transactions: true</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>Una vez configurada la conexión, puedes crear la base de datos y <em>debes</em> iniciar la base de datos con la orden <tt class="docutils literal"><span class="pre">doctrine:phpcr:init:dbal</span></tt>.</p>
<div class="highlight-bash"><div class="highlight"><pre>app/console doctrine:database:create
app/console doctrine:phpcr:init:dbal
</pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Truco</p>
<p class="last">Naturalmente, también puedes utilizar una diferente conexión en vez de la predefinida.
Es recomendable utilizar una conexión independiente para una base de datos separada si también <em>Doctrine</em> usa el acceso a datos del <em>ORM</em> o <em>DBAL</em> directamente, en lugar de mezclar este dato con las tablas generadas por <tt class="docutils literal"><span class="pre">jackalope-doctrine-dbal</span></tt>.
Si tienes una conexión separada, necesitas pasar el nombre de la conexión alterna a la orden <tt class="docutils literal"><span class="pre">doctrine:database:create</span></tt> con la opción <tt class="docutils literal"><span class="pre">--connection</span></tt>. Para las ordenes <em>PHPCR</em> de <em>Doctrine</em>, este parámetro no es necesario al configurar la conexión a utilizar.</p>
</div>
</div>
<div class="section" id="sesion-phpcr-con-midgard2">
<h4>Sesión <em>PHPCR</em> con <tt class="docutils literal"><span class="pre">Midgard2</span></tt><a class="headerlink" href="#sesion-phpcr-con-midgard2" title="Enlazar permanentemente con este título">¶</a></h4>
<p><tt class="docutils literal"><span class="pre">Midgard2</span></tt> es una aplicación que proporciona una extensión <em>PHP</em> compilada. Esta implementa la <em>API</em> de <em>PHPCR</em> en lo alto de un <em>RDBMS</em> estándar.</p>
<p>To use the Midgard2 PHPCR provider, you must have both the <a class="reference external" href="http://midgard-project.org/midgard2/#download">midgard2 PHP extension</a>
and <a class="reference external" href="http://packagist.org/packages/midgard/phpcr">the midgard/phpcr package</a> installed.
The settings here correspond to Midgard2 repository parameters as explained in <a class="reference external" href="http://midgard-project.org/phpcr/#getting_started">the getting started document</a>.</p>
<p>La sesión de configuración de la interfaz de administración es la siguiente:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># app/config/config.yml</span>
<span class="l-Scalar-Plain">doctrine_phpcr</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">session</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">backend</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">midgard2</span>
            <span class="l-Scalar-Plain">db_type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">MySQL</span>
            <span class="l-Scalar-Plain">db_name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">midgard2_test</span>
            <span class="l-Scalar-Plain">db_host</span><span class="p-Indicator">:</span> <span class="s">&quot;0.0.0.0&quot;</span>
            <span class="l-Scalar-Plain">db_port</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">3306</span>
            <span class="l-Scalar-Plain">db_username</span><span class="p-Indicator">:</span> <span class="s">&quot;&quot;</span>
            <span class="l-Scalar-Plain">db_password</span><span class="p-Indicator">:</span> <span class="s">&quot;&quot;</span>
            <span class="l-Scalar-Plain">db_init</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">true</span>
            <span class="l-Scalar-Plain">blobdir</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/tmp/cmf-blobs</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>Para más información, por favor, ve la <a class="reference external" href="http://midgard-project.org/phpcr/">documentación oficial del PHPCR de Midgard</a>.</p>
</div>
</div>
<div class="section" id="configurando-el-phpcr-odm-de-doctrine">
<span id="reference-phpcr-odm-configuration"></span><h3>Configurando el <em>PHPCR-ODM</em> de <em>Doctrine</em><a class="headerlink" href="#configurando-el-phpcr-odm-de-doctrine" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Esta sección de configuración gestiona el sistema <em>PHPCR-ODM</em> de <em>Doctrine</em>. Si no configuras ninguna cosa aquí, los servicios <em>ODM</em> no serán cargados.</p>
<p>Si habilitas <tt class="docutils literal"><span class="pre">auto_mapping</span></tt>, puedes colocar tus asociaciones en <tt class="docutils literal"><span class="pre">&lt;Paquete&gt;/Resources/config/doctrine/&lt;Document&gt;.phpcr.xml</span></tt> resp. <tt class="docutils literal"><span class="pre">...yml</span></tt> para
configurar asociaciones a documentos proporcionadas en el directorio <tt class="docutils literal"><span class="pre">&lt;Paquete&gt;/Document</span></tt>. De lo contrario necesitas configurar manualmente la sección de asignaciones.</p>
<p>Si <tt class="docutils literal"><span class="pre">auto_generate_proxy_classes</span></tt> es <tt class="docutils literal"><span class="pre">false</span></tt>, necesitas ejecutar la orden <tt class="docutils literal"><span class="pre">cache:warmup</span></tt>
para tener las clases delegadas generadas después de que modificaste un documento. También puedes ajustar cómo y dónde generar las clases delegadas con las opciones <tt class="docutils literal"><span class="pre">proxy_dir</span></tt> y <tt class="docutils literal"><span class="pre">proxy_namespace</span></tt>. Normalmente las predefinidas están bien aquí.</p>
<p>También puedes habilitar el <a class="reference external" href="http://gitnacho.github.com/symfony-docs-es/reference/configuration/doctrine.html">almacenamiento de metadatos en caché</a>.</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><pre># app/config/config.yml
doctrine_phpcr:
    odm:
        configuration_id:     ~
        auto_mapping: true
        mappings:
            &lt;name&gt;:
                mapping:              true
                type:                 ~
                dir:                  ~
                alias:                ~
                prefix:               ~
                is_bundle:            ~
        auto_generate_proxy_classes: %kernel.debug%
        proxy_dir:            %kernel.cache_dir%/doctrine/PHPCRProxies
        proxy_namespace:      PHPCRProxies

        metadata_cache_driver:
            type:                 array
            host:                 ~
            port:                 ~
            instance_class:       ~
            class:                ~
            id:                   ~</pre>
</div>
</li>
</ul>
</div>
<div class="section" id="configuracion-de-traduccion">
<span id="phpcr-odm-multilang-config"></span><h4>Configuración de traducción<a class="headerlink" href="#configuracion-de-traduccion" title="Enlazar permanentemente con este título">¶</a></h4>
<p id="index-1">Si estás utilizando documentos multilingües, necesitas configurar los idiomas disponibles. Para más información en documentos multilingües, ve la <a class="reference external" href="http://docs.doctrine-project.org/projects/doctrine-phpcr-odm/en/latest/reference/multilang.html">documentación PHPCR-ODM en multilenguaje</a>.</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># app/config/config.yml</span>
<span class="l-Scalar-Plain">doctrine_phpcr</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">odm</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">...</span>
        <span class="l-Scalar-Plain">locales</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">en</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span><span class="nv">en</span><span class="p-Indicator">,</span> <span class="nv">de</span><span class="p-Indicator">,</span> <span class="nv">fr</span><span class="p-Indicator">]</span>
            <span class="l-Scalar-Plain">de</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span><span class="nv">de</span><span class="p-Indicator">,</span> <span class="nv">en</span><span class="p-Indicator">,</span> <span class="nv">fr</span><span class="p-Indicator">]</span>
            <span class="l-Scalar-Plain">fr</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span><span class="nv">fr</span><span class="p-Indicator">,</span> <span class="nv">en</span><span class="p-Indicator">,</span> <span class="nv">de</span><span class="p-Indicator">]</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>Este bloque define el orden de regiones alternativas para ver si un documento no está traducido al idioma requerido.</p>
</div>
</div>
<div class="section" id="ajustes-generales">
<h3>Ajustes generales<a class="headerlink" href="#ajustes-generales" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Si ajustas la ruta a <tt class="docutils literal"><span class="pre">jackrabbit_jar</span></tt>,  puedes utilizar la orden de consola <tt class="docutils literal"><span class="pre">doctrine:phpcr:jackrabbit</span></tt>  para arrancar y parar el <tt class="docutils literal"><span class="pre">jackrabbit</span></tt>.</p>
<p>Puedes poner a punto la producción de la orden <tt class="docutils literal"><span class="pre">doctrine:phpcr:dump</span></tt> con <tt class="docutils literal"><span class="pre">dump_max_line_length</span></tt>.</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># app/config/config.yml</span>
<span class="l-Scalar-Plain">doctrine_phpcr</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">jackrabbit_jar</span><span class="p-Indicator">:</span>       <span class="l-Scalar-Plain">/ruta/a/jackrabbit.jar</span>
    <span class="l-Scalar-Plain">dump_max_line_length</span><span class="p-Indicator">:</span>  <span class="l-Scalar-Plain">120</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="section" id="configurando-multiples-sesiones">
<span id="multiple-phpcr-sessions"></span><h2>Configurando múltiples sesiones<a class="headerlink" href="#configurando-multiples-sesiones" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Si necesitas más de una interfaz de administración <em>PHPCR</em>, puedes definir <tt class="docutils literal"><span class="pre">sessions</span></tt> como hijo de la información de <tt class="docutils literal"><span class="pre">session</span></tt>. Cada sesión tiene un nombre y configuración que puedes utilizar directamente en <tt class="docutils literal"><span class="pre">session</span></tt>. también puedes sobrescribir qué sesión utilizar como <tt class="docutils literal"><span class="pre">default_session</span></tt>.</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># app/config/config.yml</span>
<span class="l-Scalar-Plain">doctrine_phpcr</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">session</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">default_session</span><span class="p-Indicator">:</span>      <span class="l-Scalar-Plain">~</span>
        <span class="l-Scalar-Plain">sessions</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">&lt;name&gt;</span><span class="p-Indicator">:</span>
                <span class="l-Scalar-Plain">workspace</span><span class="p-Indicator">:</span>            <span class="l-Scalar-Plain">~</span> <span class="c1"># Requerido</span>
                <span class="l-Scalar-Plain">username</span><span class="p-Indicator">:</span>             <span class="l-Scalar-Plain">~</span>
                <span class="l-Scalar-Plain">password</span><span class="p-Indicator">:</span>             <span class="l-Scalar-Plain">~</span>
                <span class="l-Scalar-Plain">backend</span><span class="p-Indicator">:</span>
                    <span class="c1"># como arriba</span>
                <span class="l-Scalar-Plain">options</span><span class="p-Indicator">:</span>
                    <span class="c1"># como arriba</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>Si estás utilizando el <em>ODM</em>, también querrás configurar múltiples gestores de documento.</p>
<p>Dentro de la sección <em>odm</em>, puedes añadir entradas nombradas en <tt class="docutils literal"><span class="pre">document_managers</span></tt>.
Para utilizar la sesión no predefinida, especifica el atributo <tt class="docutils literal"><span class="pre">session</span></tt>.</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">odm</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">default_document_manager</span><span class="p-Indicator">:</span>  <span class="l-Scalar-Plain">~</span>
    <span class="l-Scalar-Plain">document_managers</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">&lt;name&gt;</span><span class="p-Indicator">:</span>
            <span class="c1"># mismas claves como directamente en odm, ve arriba.</span>
            <span class="l-Scalar-Plain">session</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">&lt;sessionname&gt;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p>Un ejemplo completo se ve como sigue:</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><pre>doctrine_phpcr:
    # configura las sesiones PHPCR
    session:
        sessions:

            default:
                backend: %phpcr_backend%
                workspace: %phpcr_workspace%
                username: %phpcr_user%
                password: %phpcr_pass%

            website:
                backend:
                    type: jackrabbit
                    url: %magnolia_url%
                workspace: website
                username: %magnolia_user%
                password: %magnolia_pass%

            dms:
                backend:
                    type: jackrabbit
                    url: %magnolia_url%
                workspace: dms
                username: %magnolia_user%
                password: %magnolia_pass%
    # activa la capa ODM
    odm:
        document_managers:
            default:
                session: default
                mappings:
                    SandboxMainBundle: ~
                    SymfonyCmfContentBundle: ~
                    SymfonyCmfMenuBundle: ~
                    SymfonyCmfRoutingExtraBundle: ~

            website:
                session: website
                configuration_id: sandbox_magnolia.odm_configuration
                mappings:
                    SandboxMagnoliaBundle: ~

            dms:
                session: dms
                configuration_id: sandbox_magnolia.odm_configuration
                mappings:
                    SandboxMagnoliaBundle: ~

        auto_generate_proxy_classes: %kernel.debug%</pre>
</div>
</li>
</ul>
</div>
<div class="admonition tip">
<p class="first admonition-title">Truco</p>
<p class="last">Este ejemplo también utiliza diferentes configuraciones par repositorio (ve el atributo <tt class="docutils literal"><span class="pre">repository_id</span></tt>). Este caso se explica en <a class="reference internal" href="../cookbook/phpcr-odm-custom-documentclass-mapper.html"><em>Usando una clase documento personalizada asociada con PHPCR-ODM</em></a>.</p>
</div>
</div>
<div class="section" id="servicios">
<span id="reference-phpcr-commands"></span><h2>Servicios<a class="headerlink" href="#servicios" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Puedes acceder el servicios <em>PHPCR</em> con esto:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">namespace</span> <span class="nx">Acme\DemoBundle\Controller</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Symfony\Bundle\FrameworkBundle\Controller\Controller</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">DefaultController</span> <span class="k">extends</span> <span class="nx">Controller</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">indexAction</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// instancia de la sesión PHPCR</span>
        <span class="nv">$session</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">container</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;doctrine_phpcr.default_session&#39;</span><span class="p">);</span>
        <span class="c1">// instancia del gestor del documento ODM de PHPCR</span>
        <span class="nv">$documentManager</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">container</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;doctrine_phpcr.odm.default_document_manager&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="eventos">
<h2>Eventos<a class="headerlink" href="#eventos" title="Enlazar permanentemente con este título">¶</a></h2>
<p>You can tag services to listen to Doctrine PHPCR-ODM events. Esto trabaja de la misma manera que en el <em>ORM</em> de <em>Doctrine</em>. Las únicas diferencias son:</p>
<ul class="simple">
<li>Usa la etiqueta <tt class="docutils literal"><span class="pre">doctrine_phpcr.event_listener</span></tt> resp. <tt class="docutils literal"><span class="pre">doctrine_phpcr.event_subscriber</span></tt> en vez de <tt class="docutils literal"><span class="pre">doctrine.event_listener</span></tt>.</li>
<li>expect the argument to be of class <tt class="docutils literal"><span class="pre">Doctrine\ODM\PHPCR\Event\LifecycleEventArgs</span></tt> rather than in the ORM namespace.</li>
</ul>
<p>(this is subject to change, as doctrine commons 2.4 provides a common class for this event).</p>
<p>You can register for the events as described in <a class="reference external" href="http://docs.doctrine-project.org/projects/doctrine-phpcr-odm/en/latest/reference/events.html">the PHPCR-ODM documentation</a>.
Or you can tag your services as event listeners resp. event subscribers.</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">services</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">my.listener</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">class</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Acme\SearchBundle\EventListener\SearchIndexer</span>
            <span class="l-Scalar-Plain">tags</span><span class="p-Indicator">:</span>
                    <span class="p-Indicator">-</span> <span class="p-Indicator">{</span> <span class="nv">name</span><span class="p-Indicator">:</span> <span class="nv">doctrine_phpcr.event_listener</span><span class="p-Indicator">,</span> <span class="nv">event</span><span class="p-Indicator">:</span> <span class="nv">postPersist</span> <span class="p-Indicator">}</span>

    <span class="l-Scalar-Plain">my.subscriber</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">class</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Acme\SearchBundle\EventSubscriber\MySubscriber</span>
            <span class="l-Scalar-Plain">tags</span><span class="p-Indicator">:</span>
                    <span class="p-Indicator">-</span> <span class="p-Indicator">{</span> <span class="nv">name</span><span class="p-Indicator">:</span> <span class="nv">doctrine_phpcr.event_subscriber</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="admonition hint">
<p class="first admonition-title">Consejo</p>
<p class="last">Doctrine event subscribers (both ORM and PHPCR-ODM) can not
return a flexible array of methods to call like the <a class="reference external" href="http://symfony.com/doc/master/components/event_dispatcher/introduction.html#using-event-subscribers">Symfony event subscriber</a>
can do. Doctrine event subscribers must return a simple array of the event
names they subscribe to. Doctrine will then expect methods on the subscriber
with the names of the subscribed events, just as when using an event listener.</p>
</div>
<p>More information with PHP code examples for the doctrine event system integration is in
this <a class="reference external" href="http://symfony.com/doc/current/cookbook/doctrine/event_listeners_subscribers.html">Symfony cookbook entry</a>.</p>
</div>
<div class="section" id="constraint-validator">
<h2>Constraint validator<a class="headerlink" href="#constraint-validator" title="Enlazar permanentemente con este título">¶</a></h2>
<p>The bundle provides a <tt class="docutils literal"><span class="pre">ValidPhpcrOdm</span></tt> constraint validator you can use to
check if your document <tt class="docutils literal"><span class="pre">Id</span></tt> or <tt class="docutils literal"><span class="pre">Nodename</span></tt> and <tt class="docutils literal"><span class="pre">Parent</span></tt> fields are
correct.</p>
<div class="configuration-block">
<ul class="simple">
<li><em>YAML</em><div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># src/Acme/BlogBundle/Resources/config/validation.yml</span>
<span class="l-Scalar-Plain">Acme\BlogBundle\Entity\Author</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">constraints</span><span class="p-Indicator">:</span>
        <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">Doctrine\Bundle\PHPCRBundle\Validator\Constraints\ValidPhpcrOdm</span>
</pre></div>
</div>
</li>
<li><em>PHP</em><div class="highlight-php"><div class="highlight"><pre><span class="c1">// src/Acme/BlogBundle/Entity/Author.php</span>

<span class="c1">// ...</span>
<span class="k">use</span> <span class="nx">Doctrine\Bundle\PHPCRBundle\Validator\Constraints</span> <span class="k">as</span> <span class="nx">OdmAssert</span><span class="p">;</span>

<span class="sd">/**</span>
<span class="sd"> * @OdmAssert\ValidPhpcrOdm</span>
<span class="sd"> */</span>
<span class="k">class</span> <span class="nc">Author</span>
<span class="p">{</span>
   <span class="o">...</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><em>XML</em><div class="highlight-xml"><div class="highlight"><pre><span class="c">&lt;!-- Resources/config/validation.xml --&gt;</span>
<span class="cp">&lt;?xml version=&quot;1.0&quot; ?&gt;</span>
<span class="nt">&lt;constraint-mapping</span> <span class="na">xmlns=</span><span class="s">&quot;http://symfony.com/schema/dic/constraint-mapping&quot;</span>
    <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
    <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://symfony.com/schema/dic/constraint-mapping</span>
<span class="s">        http://symfony.com/schema/dic/constraint-mapping/constraint-mapping-1.0.xsd&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;class</span> <span class="na">name=</span><span class="s">&quot;Symfony\Cmf\Bundle\RoutingExtraBundle\Document\Route&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;constraint</span> <span class="na">name=</span><span class="s">&quot;Doctrine\Bundle\PHPCRBundle\Validator\Constraints\ValidPhpcrOdm&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/class&gt;</span>
<span class="nt">&lt;/constraint-mapping&gt;</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<div class="section" id="form-types">
<h2>Form types<a class="headerlink" href="#form-types" title="Enlazar permanentemente con este título">¶</a></h2>
<p>The bundle provides a couple of handy form types for PHPCR and PHPCR-ODM specific cases, along with form type guessers.</p>
<div class="section" id="phpcr-odm-image">
<h3><tt class="docutils literal"><span class="pre">phpcr_odm_image</span></tt><a class="headerlink" href="#phpcr-odm-image" title="Enlazar permanentemente con este título">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">phpcr_odm_image</span></tt> form maps to a document of type <tt class="docutils literal"><span class="pre">Doctrine\ODM\PHPCR\Document\Image</span></tt>
and provides a preview of the uploaded image. To use it, you need to include the
<a class="reference external" href="https://github.com/liip/LiipImagineBundle/">LiipImagineBundle</a> in your project and define an
imagine filter for thumbnails.</p>
<p>This form type is only available if explicitly enabled in your application configuration
by defining the <tt class="docutils literal"><span class="pre">imagine</span></tt> section under the <tt class="docutils literal"><span class="pre">odm</span></tt> section with at least <tt class="docutils literal"><span class="pre">enabled:</span> <span class="pre">true</span></tt>.
You can also configure the imagine filter to use for the preview, as well as additional
filters to remove from cache when the image is replaced. If the filter is not specified,
it defaults to <tt class="docutils literal"><span class="pre">image_upload_thumbnail</span></tt>.</p>
<p>Then you can add images to document forms as follows:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">use</span> <span class="nx">Symfony\Component\Form\FormBuilderInterface</span><span class="p">;</span>

<span class="k">protected</span> <span class="k">function</span> <span class="nf">configureFormFields</span><span class="p">(</span><span class="nx">FormBuilderInterface</span> <span class="nv">$formBuilder</span><span class="p">)</span>
<span class="p">{</span>
     <span class="nv">$formBuilder</span>
        <span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;image&#39;</span><span class="p">,</span> <span class="s1">&#39;phpcr_odm_image&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;required&#39;</span> <span class="o">=&gt;</span> <span class="k">false</span><span class="p">))</span>
     <span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Truco</p>
<p class="last">If you set required to true for the image, the user must re-upload a new image
each time he edits the form. If the document must have an image, it makes sense
to require the field when creating a new document, but make it optional when
editing an existing document.
We are <a class="reference external" href="https://groups.google.com/forum/?fromgroups=#!topic/symfony2/CrooBoaAlO4">trying to make this automatic</a>.</p>
</div>
<p>Next you will need to add the <tt class="docutils literal"><span class="pre">fields.html.twig</span></tt> template from the DoctrinePHPCRBundle to the form.resources,
to actually see the preview of the uploaded image in the backend.</p>
<p>The document that should contain the Image document has to implement a setter method.
To profit from the automatic guesser of the form layer, the name in the form element
and this method name have to match:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">public</span> <span class="k">function</span> <span class="nf">setImage</span><span class="p">(</span><span class="nv">$image</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$image</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Esto es normal y sucede cuándo ninguna nueva imagen se ha cargado</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">image</span> <span class="o">&amp;&amp;</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">image</span><span class="o">-&gt;</span><span class="na">getFile</span><span class="p">())</span> <span class="p">{</span>
        <span class="c1">// PENDIENTE: necesario hasta que se haya corregidi este fallo en PHPCRODM: https://github.com/doctrine/phpcr-odm/pull/262</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">image</span><span class="o">-&gt;</span><span class="na">getFile</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">setFileContent</span><span class="p">(</span><span class="nv">$image</span><span class="o">-&gt;</span><span class="na">getFile</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getFileContent</span><span class="p">());</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">image</span> <span class="o">=</span> <span class="nv">$image</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>To delete an image, you need to delete the document containing the image. (There is a proposal
to improve the user experience for that in a <a class="reference external" href="https://github.com/doctrine/DoctrinePHPCRBundle/issues/40">DoctrinePHPCRBundle issue</a>.)</p>
</div>
<div class="section" id="phpcr-odm-reference-collection">
<h3>phpcr_odm_reference_collection<a class="headerlink" href="#phpcr-odm-reference-collection" title="Enlazar permanentemente con este título">¶</a></h3>
<p>This form type handles editing <tt class="docutils literal"><span class="pre">ReferenceMany</span></tt> collections on PHPCR-ODM documents.
It is a choice field with an added <tt class="docutils literal"><span class="pre">referenced_class</span></tt> required option that specifies
the class of the referenced target document.</p>
<p>To use this form type, you also need to specify the list of possible reference targets as an array of PHPCR-ODM ids or
PHPCR paths.</p>
<p>The minimal code required to use this type looks as follows:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$dataArr</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;/some/phpcr/path/item_1&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;first item&#39;</span><span class="p">,</span>
    <span class="s1">&#39;/some/phpcr/path/item_2&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;second item&#39;</span><span class="p">,</span>
<span class="p">);</span>

<span class="nv">$formMapper</span>
    <span class="o">-&gt;</span><span class="na">with</span><span class="p">(</span><span class="s1">&#39;form.group_general&#39;</span><span class="p">)</span>
        <span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;myCollection&#39;</span><span class="p">,</span> <span class="s1">&#39;phpcr_odm_reference_collection&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;choices&#39;</span>   <span class="o">=&gt;</span> <span class="nv">$dataArr</span><span class="p">,</span>
            <span class="s1">&#39;referenced_class&#39;</span>  <span class="o">=&gt;</span> <span class="s1">&#39;Class\Of\My\Referenced\Documents&#39;</span><span class="p">,</span>
        <span class="p">))</span>
    <span class="o">-&gt;</span><span class="na">end</span><span class="p">();</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Truco</p>
<p class="last">When building an admin interface with <a class="reference internal" href="doctrine_phpcr_admin.html"><em>Sonata Admin</em></a>
there is also the <tt class="docutils literal"><span class="pre">sonata_type_model</span></tt> that is more powerful, allowing to add
to the referenced documents on the fly. Unfortunately it is
<a href="#id4"><span class="problematic" id="id5">`currently broken&lt;https://github.com/sonata-project/SonataDoctrineORMAdminBundle/issues/145&gt;`_</span></a>.</p>
</div>
</div>
<div class="section" id="phpcr-reference">
<h3>phpcr_reference<a class="headerlink" href="#phpcr-reference" title="Enlazar permanentemente con este título">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">phpcr_reference</span></tt> represents a PHPCR Property of type REFERENCE or WEAKREFERENCE within a form.
The input will be rendered as a text field containing either the PATH or the UUID as per the
configuration. The form will resolve the path or id back to a PHPCR node to set the reference.</p>
<p>This type extends the <tt class="docutils literal"><span class="pre">text</span></tt> form type. It adds an option <tt class="docutils literal"><span class="pre">transformer_type</span></tt> that can be set
to either <tt class="docutils literal"><span class="pre">path</span></tt> or <tt class="docutils literal"><span class="pre">uuid</span></tt>.</p>
</div>
</div>
<div class="section" id="fixture-loading">
<h2>Fixture loading<a class="headerlink" href="#fixture-loading" title="Enlazar permanentemente con este título">¶</a></h2>
<p>To use the <tt class="docutils literal"><span class="pre">doctrine:phpcr:fixtures:load</span></tt> command, you additionally need to install the
<a class="reference external" href="http://symfony.com/doc/current/bundles/DoctrineFixturesBundle/index.html">DoctrineFixturesBundle</a> which brings the
<a class="reference external" href="https://github.com/doctrine/data-fixtures">Doctrine data-fixtures</a> into Symfony2.</p>
<p>Fixtures work the same way they work for Doctrine ORM. You write fixture classes implementing
<tt class="docutils literal"><span class="pre">Doctrine\Common\DataFixtures\FixtureInterface</span></tt>. If you place them in &lt;Bundle&gt;DataFixturesPHPCR,
they will be autodetected if you specify no path to the fixture loading command.</p>
<p>A simple example fixture class looks like this:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">namespace</span> <span class="nx">MyBundle\DataFixtures\PHPCR</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Doctrine\Common\Persistence\ObjectManager</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Doctrine\Common\DataFixtures\FixtureInterface</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">LoadMyData</span> <span class="k">implements</span> <span class="nx">FixtureInterface</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">load</span><span class="p">(</span><span class="nx">ObjectManager</span> <span class="nv">$manager</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// Create and persist your data here...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>For more on fixtures, see the <a class="reference external" href="http://symfony.com/doc/current/bundles/DoctrineFixturesBundle/index.html">documentation of the DoctrineFixturesBundle</a>.</p>
</div>
<div class="section" id="ordenes-del-phpcr-de-doctrine">
<h2>Órdenes del <em>PHPCR</em> de <em>Doctrine</em><a class="headerlink" href="#ordenes-del-phpcr-de-doctrine" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Todas las órdenes sobre el <em>PHPCR</em> van prefijadas con <tt class="docutils literal"><span class="pre">doctrine:phpcr</span></tt> y puedes utilizar el argumento <tt class="docutils literal"><span class="pre">--session</span></tt> para utilizar una sesión distinta a la predefinida si configuraste varias sesiones <em>PHPCR</em>.</p>
<p>Algunas de estas órdenes son específicas a una interfaz de administración o al <em>ODM</em>. Esas órdenes
sólo estarán disponibles si tal interfaz de administración está configurada.</p>
<p>Usa <tt class="docutils literal"><span class="pre">app/console</span> <span class="pre">help</span> <span class="pre">&lt;orden&gt;</span></tt> para ver todas las opciones que tiene cada orden.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">doctrine:phpcr:workspace:create</span></tt>  Create a workspace in the configured repository</li>
<li><tt class="docutils literal"><span class="pre">doctrine:phpcr:workspace:list</span></tt>  List all available workspaces in the configured repository</li>
<li><tt class="docutils literal"><span class="pre">doctrine:phpcr:purge</span></tt>  Remove a subtree or all content from the repository</li>
<li><tt class="docutils literal"><span class="pre">doctrine:phpcr:register-system-node-types</span></tt>  Register system node types in the PHPCR repository</li>
<li><tt class="docutils literal"><span class="pre">doctrine:phpcr:register-node-types</span></tt>  Register node types from a .cnd file in the PHPCR repository</li>
<li><tt class="docutils literal"><span class="pre">doctrine:phpcr:fixtures:load</span></tt>  Load data fixtures to your PHPCR database.</li>
<li><tt class="docutils literal"><span class="pre">doctrine:phpcr:import</span></tt>  Import xml data into the repository, either in JCR system view format or arbitrary xml</li>
<li><tt class="docutils literal"><span class="pre">doctrine:phpcr:export</span></tt>  Export nodes from the repository, either to the JCR system view format or the document view format</li>
<li><tt class="docutils literal"><span class="pre">doctrine:phpcr:dump</span></tt>  Output all or some content of the repository</li>
<li><tt class="docutils literal"><span class="pre">doctrine:phpcr:query</span></tt>  Execute a JCR SQL2 statement</li>
<li><tt class="docutils literal"><span class="pre">doctrine:phpcr:mapping:info</span></tt>  Shows basic information about all mapped documents</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Nota</p>
<p class="last">To use the <tt class="docutils literal"><span class="pre">doctrine:phpcr:fixtures:load</span></tt> command, you additionally need to install the
<a class="reference external" href="http://symfony.com/doc/current/bundles/DoctrineFixturesBundle/index.html">DoctrineFixturesBundle</a>
and its dependencies. Ve su página de documentación para aprender a utilizar los accesorios.</p>
</div>
<div class="section" id="ordenes-especificas-de-jackrabbit">
<h3>Órdenes específicas de <tt class="docutils literal"><span class="pre">Jackrabbit</span></tt><a class="headerlink" href="#ordenes-especificas-de-jackrabbit" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Si estás utilizando <tt class="docutils literal"><span class="pre">jackalope-jackrabbit</span></tt>, también tienes una orden para arrancar y detener el servidor <tt class="docutils literal"><span class="pre">jackrabbit</span></tt>:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">jackalope:run:jackrabbit</span></tt>  Arranca y detiene el servidor <tt class="docutils literal"><span class="pre">Jackrabbit</span></tt></li>
</ul>
</div>
<div class="section" id="ordenes-especificas-para-el-dbal-de-doctrine">
<h3>Órdenes específicas para el <em>DBAL</em> de <em>Doctrine</em><a class="headerlink" href="#ordenes-especificas-para-el-dbal-de-doctrine" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Si estás utilizando <tt class="docutils literal"><span class="pre">jackalope-doctrine-dbal</span></tt>,  tienes una orden para iniciar la base
de datos:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">jackalope:init:dbal</span></tt>   Prepara la base de datos para el <em>DBAL</em> de <em>Doctrine</em> con <tt class="docutils literal"><span class="pre">Jackalope</span></tt></li>
</ul>
<p>Ten en cuenta que también puedes utilizar la orden <em>dbal</em> de <em>doctrine</em> para crear la base de datos.</p>
</div>
<div class="section" id="algunas-ordenes-de-ejemplo">
<h3>Algunas ordenes de ejemplo<a class="headerlink" href="#algunas-ordenes-de-ejemplo" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Ejecutando <a class="reference external" href="http://www.h2database.com/jcr/grammar.html">consultas SQL2</a> contra el repositorio</p>
<div class="highlight-bash"><div class="highlight"><pre>app/console doctrine:phpcr:query <span class="s2">&quot;SELECT title FROM [nt:unstructured] WHERE NAME() = &#39;home&#39;&quot;</span>
</pre></div>
</div>
<p>Vertiendo nodos bajo /cms/simple incluyendo sus propiedades</p>
<div class="highlight-bash"><div class="highlight"><pre>app/console doctrine:phpcr:dump /cms/simple --props
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  <a href="https://github.com/symfony/symfony-standard"><img style="position: fixed; top: 0; right: 0; border: 0;" src="http://gitnacho.github.com/tnp/img/comun/bifurcame.png" alt="Bifúrcame en GitHub" /></a>
  
  <div style="width:740px;margin:10px auto;">
    <div class="related">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="Índice General"
             >índice</a></li>
        <li class="right" >
          <a href="menu.html" title="MenuBundle"
             >siguiente</a> |</li>
        <li class="right" >
          <a href="create.html" title="CreateBundle"
             >anterior</a> |</li>
        <li><a href="../../index.html">en Español</a> &raquo;</li>
          <li><a href="../index.html" >Documentación del <tt class="docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal"><span class="pre">CMF</span></tt> de <em>Symfony</em></a> &raquo;</li> 
      </ul>
    </div>
  </div>


   <div style="width: 740px; margin: 0 auto;">
     <div id="disqus_thread"></div>
     
    <div class="footer">
        &copy; Copyright 2011-2013, Traducido por Nacho Pacheco.
      Actualizado por última vez en Mar 19, 2013.
      Creado con <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
   </div>
   <script type="text/javascript">
    var disqus_shortname = 'documentos-mx';
    var disqus_developer = 1;
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
   </script>
   <noscript>
     Por favor activa JavaScript para ver los <a href="http://disqus.com/?ref_noscript">comentarios accionados por Disqus.</a>
   </noscript>

  </body>
</html>