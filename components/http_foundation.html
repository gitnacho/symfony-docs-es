
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>El componente HttpFoundation &mdash; Manual de Symfony2 en Español</title>
    
    <link rel="stylesheet" href="../_static/tnp.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.0.14',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <link rel="shortcut icon" href="../_static/icotnp.ico"/>
    <link rel="top" title="Manual de Symfony2 en Español" href="../index.html" /> 
  </head>
  <body>
  <div class="imalogo">
    
  <a href="../index.html"><img src="http://gitnacho.github.com/tnp/img/sf/logo-big.gif" alt="Edición estándar de Symfony2" />
  
    <a href="http://gitnacho.github.com/tnp/"><img src="http://gitnacho.github.com/tnp/_static/normaltnp.png" alt="Traducciones de Nacho Pacheco" /></a>
    <div class="social">
      <a href="https://twitter.com/share" class="twitter-share-button" data-via="esymfony" data-lang="es">Tweet</a>
      <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
    </div>
    <div id="searchbox">
      <form class="searc " action="../search.html" method="get">
      <input type="search" name="q" placeholder="Término a buscar" />
      <input type="submit" value="Ir" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <script type="text/javascript">$('#searchbox').show(0);</script>
    </div>
    

    
    <div class="related">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Índice General"
             accesskey="I">índice</a></li>
        <li><a href="../index.html">en Español</a> &raquo;</li> 
      </ul>
    </div>
  </div>


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="el-componente-httpfoundation">
<span id="index-0"></span><h1>El componente <tt class="docutils literal"><span class="pre">HttpFoundation</span></tt><a class="headerlink" href="#el-componente-httpfoundation" title="Enlazar permanentemente con este título">¶</a></h1>
<blockquote>
<div>El componente <tt class="docutils literal"><span class="pre">HttpFoundation</span></tt> define una capa orientada a objetos para la especificación <em>HTTP</em>.</div></blockquote>
<p>En <em>PHP</em>, la petición está representada por algunas variables globales (<tt class="docutils literal"><span class="pre">$_GET</span></tt>, <tt class="docutils literal"><span class="pre">$_POST</span></tt>, <tt class="docutils literal"><span class="pre">$_FILE</span></tt>, <tt class="docutils literal"><span class="pre">$_COOKIE</span></tt>, <tt class="docutils literal"><span class="pre">$_SESSION</span></tt>...) y la respuesta es generada por algunas funciones (<tt class="docutils literal"><span class="pre">echo</span></tt>, <tt class="docutils literal"><span class="pre">header</span></tt>, <tt class="docutils literal"><span class="pre">setcookie</span></tt>, ...).</p>
<p>El componente <em>HttpFoundation</em> de <em>Symfony2</em> sustituye estas variables globales y funciones de <em>PHP</em> por una capa orientada a objetos.</p>
<div class="section" id="instalando">
<h2>Instalando<a class="headerlink" href="#instalando" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Puedes instalar el componente de varias maneras diferentes:</p>
<ul class="simple">
<li>Usando el repositorio <em>Git</em> oficial (<a class="reference external" href="https://github.com/symfony/HttpFoundation">https://github.com/symfony/HttpFoundation</a>);</li>
<li>Instalándolo a través de <em>PEAR</em> (<cite>pear.symfony.com/HttpFoundation</cite>);</li>
<li>Instalándolo vía <tt class="docutils literal"><span class="pre">Composer</span></tt> (<cite>symfony/http-foundation</cite> en Packagist).</li>
</ul>
</div>
<div class="section" id="peticion">
<h2>Petición<a class="headerlink" href="#peticion" title="Enlazar permanentemente con este título">¶</a></h2>
<p>La manera más común para crear una petición es basándose en las variables globales de <em>PHP</em> con
<tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Request.html#createFromGlobals()" title="Symfony\Component\HttpFoundation\Request::createFromGlobals()"><span class="pre">createFromGlobals()</span></a></tt>:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\Request</span><span class="p">;</span>

<span class="nv">$request</span> <span class="o">=</span> <span class="nx">Request</span><span class="o">::</span><span class="na">createFromGlobals</span><span class="p">();</span>
</pre></div>
</div>
<p>que es casi equivalente a la más prolija, pero también más flexible, llamada a
<tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Request.html#__construct()" title="Symfony\Component\HttpFoundation\Request::__construct()"><span class="pre">__construct()</span></a></tt>:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Request</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">,</span> <span class="nv">$_POST</span><span class="p">,</span> <span class="k">array</span><span class="p">(),</span> <span class="nv">$_COOKIE</span><span class="p">,</span> <span class="nv">$_FILES</span><span class="p">,</span> <span class="nv">$_SERVER</span><span class="p">);</span>
</pre></div>
</div>
<div class="section" id="accediendo-a-datos-de-la-peticion">
<h3>Accediendo a datos de la <tt class="docutils literal"><span class="pre">Petición</span></tt><a class="headerlink" href="#accediendo-a-datos-de-la-peticion" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Un objeto <tt class="docutils literal"><span class="pre">Petición</span></tt> contiene información sobre la petición del cliente. Puedes acceder a esta información a través de muchas propiedades públicas:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">request</span></tt>: equivalente de <tt class="docutils literal"><span class="pre">$_POST</span></tt>;</li>
<li><tt class="docutils literal"><span class="pre">query</span></tt>: equivalente de <tt class="docutils literal"><span class="pre">$_GET</span></tt> (<tt class="docutils literal"><span class="pre">$request-&gt;query-&gt;get('name')</span></tt>);</li>
<li><tt class="docutils literal"><span class="pre">cookies</span></tt>: equivalente de <tt class="docutils literal"><span class="pre">$_COOKIE</span></tt>;</li>
<li><tt class="docutils literal"><span class="pre">attributes</span></tt>: sin equivalente &#8212; utilizado por tu aplicación para almacenar otros datos (ve <a class="reference internal" href="http_foundation/introduction.html#component-foundation-attributes"><em>más adelante</em></a>)</li>
<li><tt class="docutils literal"><span class="pre">files</span></tt>: equivalente de <tt class="docutils literal"><span class="pre">$_FILE</span></tt>;</li>
<li><tt class="docutils literal"><span class="pre">server</span></tt>: equivalente de <tt class="docutils literal"><span class="pre">$_SERVER</span></tt>;</li>
<li><tt class="docutils literal"><span class="pre">headers</span></tt>: en su mayoría equivalente a un subconjunto de <tt class="docutils literal"><span class="pre">$_SERVER</span></tt>   (<tt class="docutils literal"><span class="pre">$request-&gt;headers-&gt;get('Content-Type')</span></tt>).</li>
</ul>
<p>Cada propiedad es una instancia de <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\ParameterBag</span></tt> (o una subclase), que es una clase que contiene datos:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">request</span></tt>: <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\ParameterBag</span></tt>;</li>
<li><tt class="docutils literal"><span class="pre">query</span></tt>:   <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\ParameterBag</span></tt>;</li>
<li><tt class="docutils literal"><span class="pre">cookies</span></tt>: <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\ParameterBag</span></tt>;</li>
<li><tt class="docutils literal"><span class="pre">attributes</span></tt>: <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\ParameterBag</span></tt>;</li>
<li><tt class="docutils literal"><span class="pre">files</span></tt>:   <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\FileBag</span></tt>;</li>
<li><tt class="docutils literal"><span class="pre">server</span></tt>:  <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\ServerBag</span></tt>;</li>
<li><tt class="docutils literal"><span class="pre">headers</span></tt>: <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\HeaderBag</span></tt>.</li>
</ul>
<p>Todas las instancias de la clase <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\ParameterBag</span></tt> tienen métodos para recuperar y actualizar sus datos:</p>
<ul class="simple">
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/ParameterBag.html#all()" title="Symfony\Component\HttpFoundation\ParameterBag::all()"><span class="pre">all()</span></a></tt>: Devuelve los parámetros;</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/ParameterBag.html#keys()" title="Symfony\Component\HttpFoundation\ParameterBag::keys()"><span class="pre">keys()</span></a></tt>: Devuelve las claves de los parámetros;</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/ParameterBag.html#replace()" title="Symfony\Component\HttpFoundation\ParameterBag::replace()"><span class="pre">replace()</span></a></tt>:
Sustituye los parámetros actuales por un nuevo conjunto;</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/ParameterBag.html#add()" title="Symfony\Component\HttpFoundation\ParameterBag::add()"><span class="pre">add()</span></a></tt>: Añade parámetros;</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/ParameterBag.html#get()" title="Symfony\Component\HttpFoundation\ParameterBag::get()"><span class="pre">get()</span></a></tt>: Devuelve un parámetro por nombre;</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/ParameterBag.html#set()" title="Symfony\Component\HttpFoundation\ParameterBag::set()"><span class="pre">set()</span></a></tt>: Establece un parámetro por nombre;</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/ParameterBag.html#has()" title="Symfony\Component\HttpFoundation\ParameterBag::has()"><span class="pre">has()</span></a></tt>: Devuelve <tt class="docutils literal"><span class="pre">true</span></tt> si el parámetro está definido;</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/ParameterBag.html#remove()" title="Symfony\Component\HttpFoundation\ParameterBag::remove()"><span class="pre">remove()</span></a></tt>: Elimina un parámetro.</li>
</ul>
<p>La instancia de <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\ParameterBag</span></tt> también tiene algunos métodos para filtrar los valores introducidos:</p>
<ul class="simple">
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Request.html#getAlpha()" title="Symfony\Component\HttpFoundation\Request::getAlpha()"><span class="pre">getAlpha()</span></a></tt>: Devuelve los caracteres alfanuméricos del valor del parámetro;</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Request.html#getAlnum()" title="Symfony\Component\HttpFoundation\Request::getAlnum()"><span class="pre">getAlnum()</span></a></tt>: Devuelve los caracteres alfanuméricos y dígitos del valor del parámetro;</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Request.html#getDigits()" title="Symfony\Component\HttpFoundation\Request::getDigits()"><span class="pre">getDigits()</span></a></tt>: Devuelve los dígitos del valor del parámetro;</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Request.html#getInt()" title="Symfony\Component\HttpFoundation\Request::getInt()"><span class="pre">getInt()</span></a></tt>: Devuelve el valor del parámetro convertido a entero;</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Request.html#filter()" title="Symfony\Component\HttpFoundation\Request::filter()"><span class="pre">filter()</span></a></tt>: Filtra el parámetro usando la función <tt class="docutils literal"><span class="pre">filter_var()</span></tt> de <em>PHP</em>.</li>
</ul>
<p>Todos los captadores toman hasta tres argumentos: el primero es el nombre del parámetro y el segundo es el valor predeterminado a devolver si el parámetro no existe:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// La cadena de consulta es &#39;?foo=bar&#39;</span>

<span class="nv">$request</span><span class="o">-&gt;</span><span class="na">query</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">);</span>
<span class="c1">// devuelve bar</span>

<span class="nv">$request</span><span class="o">-&gt;</span><span class="na">query</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;bar&#39;</span><span class="p">);</span>
<span class="c1">// devuelve null</span>

<span class="nv">$request</span><span class="o">-&gt;</span><span class="na">query</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">);</span>
<span class="c1">// devuelve &#39;bar&#39;</span>
</pre></div>
</div>
<p>Cuando <em>PHP</em> importa la consulta de la petición, manipula los parámetros de la petición como
<tt class="docutils literal"><span class="pre">foo[bar]=bar</span></tt> de una manera especial, ya que crea una matriz. Para que puedas obtener el parámetro <tt class="docutils literal"><span class="pre">foo</span></tt> y devolver una matriz con un elemento <tt class="docutils literal"><span class="pre">bar</span></tt>. pero a veces, posiblemente quieras obtener el valor por medio del nombre &#8220;original&#8221; del parámetro:
<tt class="docutils literal"><span class="pre">foo[bar]</span></tt>. Esto es posible con todos los captadores de <tt class="docutils literal"><span class="pre">ParameterBag</span></tt> como
<tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Request.html#get()" title="Symfony\Component\HttpFoundation\Request::get()"><span class="pre">get()</span></a></tt> a través del tercer argumento:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// la cadena de consulta es &#39;?foo[bar]=bar&#39;</span>

<span class="nv">$request</span><span class="o">-&gt;</span><span class="na">query</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">);</span>
<span class="c1">// devuelve array(&#39;bar&#39; =&gt; &#39;bar&#39;)</span>

<span class="nv">$request</span><span class="o">-&gt;</span><span class="na">query</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;foo[bar]&#39;</span><span class="p">);</span>
<span class="c1">// devuelve null</span>

<span class="nv">$request</span><span class="o">-&gt;</span><span class="na">query</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;foo[bar]&#39;</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
<span class="c1">// devuelve &#39;bar&#39;</span>
</pre></div>
</div>
<p id="component-foundation-attributes">Por último, pero no menos importante, también puedes almacenar más datos en la petición, gracias a la propiedad pública <tt class="docutils literal"><span class="pre">attributes</span></tt>, que también es una instancia de <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\ParameterBag</span></tt>. Casi siempre se usa para adjuntar información que pertenece a la <tt class="docutils literal"><span class="pre">Petición</span></tt> y que necesitas acceder desde diferentes puntos de tu aplicación. Para información sobre cómo se utiliza en la plataforma <em>Symfony2</em>, consulta la <a class="reference internal" href="../book/http_fundamentals.html#book-fundamentals-attributes"><em>propiedad pública attributes</em></a>.</p>
</div>
<div class="section" id="identificando-una-peticion">
<h3>Identificando una <tt class="docutils literal"><span class="pre">Petición</span></tt><a class="headerlink" href="#identificando-una-peticion" title="Enlazar permanentemente con este título">¶</a></h3>
<p>En tu aplicación, necesitas una manera de identificar una petición; la mayor parte del tiempo, esto se hace a través de la &#8220;información de ruta&#8221; de la petición, a la que puedes acceder a través del método <tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Request.html#getPathInfo()" title="Symfony\Component\HttpFoundation\Request::getPathInfo()"><span class="pre">getPathInfo()</span></a></tt>:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// Para una petición a http://example.com/blog/index.php/post/hello-world</span>
<span class="c1">// la información de ruta es &quot;/post/hello-world&quot;</span>
<span class="nv">$request</span><span class="o">-&gt;</span><span class="na">getPathInfo</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="simulando-una-peticion">
<h3>Simulando una <tt class="docutils literal"><span class="pre">Petición</span></tt><a class="headerlink" href="#simulando-una-peticion" title="Enlazar permanentemente con este título">¶</a></h3>
<p>En lugar de crear una petición basada en las variables globales de <em>PHP</em>, también puedes simular
una <tt class="docutils literal"><span class="pre">Petición</span></tt>:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$request</span> <span class="o">=</span> <span class="nx">Request</span><span class="o">::</span><span class="na">create</span><span class="p">(</span><span class="s1">&#39;/hello-world&#39;</span><span class="p">,</span> <span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;name&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Fabien&#39;</span><span class="p">));</span>
</pre></div>
</div>
<p>El método <tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Request.html#create()" title="Symfony\Component\HttpFoundation\Request::create()"><span class="pre">create()</span></a></tt> crea una petición basándose en la información de una ruta, un método y algunos parámetros (los parámetros de consulta o los de la petición en función del método <em>HTTP</em>); y, por supuesto, también puedes sustituir todas las otras variables (de manera predeterminada, <em>Symfony</em> crea parámetros predeterminados apropiados para todas las variables globales de <em>PHP</em>).</p>
<p>En base a dicha petición, puedes sustituir las variables globales de <em>PHP</em> a través de <tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Request.html#overrideGlobals()" title="Symfony\Component\HttpFoundation\Request::overrideGlobals()"><span class="pre">overrideGlobals()</span></a></tt>:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$request</span><span class="o">-&gt;</span><span class="na">overrideGlobals</span><span class="p">();</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Truco</p>
<p class="last">También puedes duplicar una consulta existente a través del método <tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Request.html#duplicate()" title="Symfony\Component\HttpFoundation\Request::duplicate()"><span class="pre">duplicate()</span></a></tt> o cambiar un montón de parámetros con una sola llamada a <tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Request.html#initialize()" title="Symfony\Component\HttpFoundation\Request::initialize()"><span class="pre">initialize()</span></a></tt>.</p>
</div>
</div>
<div class="section" id="accediendo-a-la-sesion">
<h3>Accediendo a la <tt class="docutils literal"><span class="pre">Sesión</span></tt><a class="headerlink" href="#accediendo-a-la-sesion" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Si tienes una sesión adjunta a la <tt class="docutils literal"><span class="pre">Petición</span></tt>, puedes acceder a ella a través del método <tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Request.html#getSession()" title="Symfony\Component\HttpFoundation\Request::getSession()"><span class="pre">getSession()</span></a></tt>;
el método <tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Request.html#hasPreviousSession()" title="Symfony\Component\HttpFoundation\Request::hasPreviousSession()"><span class="pre">hasPreviousSession()</span></a></tt> te dice si la petición contiene una sesión que se inició en una de las peticiones anteriores.</p>
</div>
<div class="section" id="accediendo-a-otros-datos">
<h3>Accediendo a otros datos<a class="headerlink" href="#accediendo-a-otros-datos" title="Enlazar permanentemente con este título">¶</a></h3>
<p>La clase <tt class="docutils literal"><span class="pre">Petición</span></tt> tiene muchos otros métodos que puedes utilizar para acceder a la información de la petición. Echa un vistazo a la <em>API</em> para más información sobre ellos.</p>
</div>
</div>
<div class="section" id="respuesta">
<h2><tt class="docutils literal"><span class="pre">Respuesta</span></tt><a class="headerlink" href="#respuesta" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Un objeto <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Response</span></tt> contiene toda la información que debes enviar de vuelta al cliente desde una determinada <tt class="docutils literal"><span class="pre">Petición</span></tt>. El constructor toma hasta tres argumentos: el contenido de la respuesta, el código de estado, y una serie de cabeceras <em>HTTP</em>:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\Response</span><span class="p">;</span>

<span class="nv">$response</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Response</span><span class="p">(</span><span class="s1">&#39;Content&#39;</span><span class="p">,</span>
                         <span class="mi">200</span><span class="p">,</span>
                         <span class="k">array</span><span class="p">(</span><span class="s1">&#39;content-type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;text/html&#39;</span><span class="p">)</span>
                <span class="p">);</span>
</pre></div>
</div>
<p>También puedes manipular esta información después de haber creado la <tt class="docutils literal"><span class="pre">Respuesta</span></tt>:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$response</span><span class="o">-&gt;</span><span class="na">setContent</span><span class="p">(</span><span class="s1">&#39;Hello World&#39;</span><span class="p">);</span>

<span class="c1">// el atributo público headers es un ResponseHeaderBag</span>
<span class="nv">$response</span><span class="o">-&gt;</span><span class="na">headers</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">,</span> <span class="s1">&#39;text/plain&#39;</span><span class="p">);</span>

<span class="nv">$response</span><span class="o">-&gt;</span><span class="na">setStatusCode</span><span class="p">(</span><span class="mi">404</span><span class="p">);</span>
</pre></div>
</div>
<p>Al establecer el <tt class="docutils literal"><span class="pre">Content-Type</span></tt> de la respuesta, puedes configurar el juego de caracteres, pero es mejor configurarlo a través del método <tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Response.html#setCharset()" title="Symfony\Component\HttpFoundation\Response::setCharset()"><span class="pre">setCharset()</span></a></tt>:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$response</span><span class="o">-&gt;</span><span class="na">setCharset</span><span class="p">(</span><span class="s1">&#39;ISO-8859-1&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>Ten en cuenta que de manera predeterminada, <em>Symfony</em> asume que sus respuestas están codificadas en
<em>UTF-8</em>.</p>
<div class="section" id="enviando-la-respuesta">
<h3>Enviando la <tt class="docutils literal"><span class="pre">Respuesta</span></tt><a class="headerlink" href="#enviando-la-respuesta" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Antes de enviar la respuesta, te puedes asegurar de que es compatible con la especificación del protocolo <em>HTTP</em> llamando al método <tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Response.html#prepare()" title="Symfony\Component\HttpFoundation\Response::prepare()"><span class="pre">prepare()</span></a></tt>:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$response</span><span class="o">-&gt;</span><span class="na">prepare</span><span class="p">(</span><span class="nv">$request</span><span class="p">);</span>
</pre></div>
</div>
<p>Enviar la respuesta entonces es tan sencillo cómo invocar al método <tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Response.html#send()" title="Symfony\Component\HttpFoundation\Response::send()"><span class="pre">send()</span></a></tt>:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$response</span><span class="o">-&gt;</span><span class="na">send</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="enviando-cookies">
<h3>Enviando <tt class="docutils literal"><span class="pre">Cookies</span></tt><a class="headerlink" href="#enviando-cookies" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Puedes manipular las <tt class="docutils literal"><span class="pre">cookies</span></tt> de la respuesta por medio del atributo público <tt class="docutils literal"><span class="pre">headers</span></tt>:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\Cookie</span><span class="p">;</span>

<span class="nv">$response</span><span class="o">-&gt;</span><span class="na">headers</span><span class="o">-&gt;</span><span class="na">setCookie</span><span class="p">(</span><span class="k">new</span> <span class="nx">Cookie</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">));</span>
</pre></div>
</div>
<p>El método <tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/ResponseHeaderBag.html#setCookie()" title="Symfony\Component\HttpFoundation\ResponseHeaderBag::setCookie()"><span class="pre">setCookie()</span></a></tt> toma como argumento una instancia de <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Cookie</span></tt>.</p>
<p>Puedes borrar una <em class="dfn">cookie</em> a través del método <tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Response.html#clearCookie()" title="Symfony\Component\HttpFoundation\Response::clearCookie()"><span class="pre">clearCookie()</span></a></tt>.</p>
</div>
<div class="section" id="gestionando-la-cache-http">
<h3>Gestionando la caché <em>HTTP</em><a class="headerlink" href="#gestionando-la-cache-http" title="Enlazar permanentemente con este título">¶</a></h3>
<p>La clase <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Response</span></tt> tiene un rico conjunto de métodos para manipular las cabeceras <em>HTTP</em> relacionadas con la memoria caché:</p>
<ul class="simple">
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Response.html#setPublic()" title="Symfony\Component\HttpFoundation\Response::setPublic()"><span class="pre">setPublic()</span></a></tt>;</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Response.html#setPrivate()" title="Symfony\Component\HttpFoundation\Response::setPrivate()"><span class="pre">setPrivate()</span></a></tt>;</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Response.html#expire()" title="Symfony\Component\HttpFoundation\Response::expire()"><span class="pre">expire()</span></a></tt>;</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Response.html#setExpires()" title="Symfony\Component\HttpFoundation\Response::setExpires()"><span class="pre">setExpires()</span></a></tt>;</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Response.html#setMaxAge()" title="Symfony\Component\HttpFoundation\Response::setMaxAge()"><span class="pre">setMaxAge()</span></a></tt>;</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Response.html#setSharedMaxAge()" title="Symfony\Component\HttpFoundation\Response::setSharedMaxAge()"><span class="pre">setSharedMaxAge()</span></a></tt>;</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Response.html#setTtl()" title="Symfony\Component\HttpFoundation\Response::setTtl()"><span class="pre">setTtl()</span></a></tt>;</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Response.html#setClientTtl()" title="Symfony\Component\HttpFoundation\Response::setClientTtl()"><span class="pre">setClientTtl()</span></a></tt>;</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Response.html#setLastModified()" title="Symfony\Component\HttpFoundation\Response::setLastModified()"><span class="pre">setLastModified()</span></a></tt>;</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Response.html#setEtag()" title="Symfony\Component\HttpFoundation\Response::setEtag()"><span class="pre">setEtag()</span></a></tt>;</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Response.html#setVary()" title="Symfony\Component\HttpFoundation\Response::setVary()"><span class="pre">setVary()</span></a></tt>;</li>
</ul>
<p>Puedes utilizar el método <tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Response.html#setCache()" title="Symfony\Component\HttpFoundation\Response::setCache()"><span class="pre">setCache()</span></a></tt> para establecer la información de caché utilizada comúnmente en una llamada al método:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$response</span><span class="o">-&gt;</span><span class="na">setCache</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;etag&#39;</span>          <span class="o">=&gt;</span> <span class="s1">&#39;abcdef&#39;</span><span class="p">,</span>
    <span class="s1">&#39;last_modified&#39;</span> <span class="o">=&gt;</span> <span class="k">new</span> <span class="nx">\DateTime</span><span class="p">(),</span>
    <span class="s1">&#39;max_age&#39;</span>       <span class="o">=&gt;</span> <span class="mi">600</span><span class="p">,</span>
    <span class="s1">&#39;s_maxage&#39;</span>      <span class="o">=&gt;</span> <span class="mi">600</span><span class="p">,</span>
    <span class="s1">&#39;private&#39;</span>       <span class="o">=&gt;</span> <span class="k">false</span><span class="p">,</span>
    <span class="s1">&#39;public&#39;</span>        <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
<span class="p">));</span>
</pre></div>
</div>
<p>Para comprobar si los validadores de la <tt class="docutils literal"><span class="pre">Respuesta</span></tt> (<tt class="docutils literal"><span class="pre">ETag</span></tt>, <tt class="docutils literal"><span class="pre">Last-Modified</span></tt>) coinciden con un valor condicional especificado en la petición del cliente, utiliza el método <tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Response.html#isNotModified()" title="Symfony\Component\HttpFoundation\Response::isNotModified()"><span class="pre">isNotModified()</span></a></tt>:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">if</span> <span class="p">(</span><span class="nv">$response</span><span class="o">-&gt;</span><span class="na">isNotModified</span><span class="p">(</span><span class="nv">$request</span><span class="p">))</span> <span class="p">{</span>
    <span class="nv">$response</span><span class="o">-&gt;</span><span class="na">send</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Si la respuesta no se ha modificado, se establece el código de estado a 304 y elimina el contenido real de la respuesta.</p>
</div>
<div class="section" id="redirigiendo-al-usuario">
<h3>Redirigiendo al usuario<a class="headerlink" href="#redirigiendo-al-usuario" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Para redirigir al cliente a otra <em>URL</em>, puedes utilizar la clase <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\RedirectResponse</span></tt>:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\RedirectResponse</span><span class="p">;</span>

<span class="nv">$response</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">RedirectResponse</span><span class="p">(</span><span class="s1">&#39;http://ejemplo.com/&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="transmitiendo-una-respuesta">
<h3>Transmitiendo una <tt class="docutils literal"><span class="pre">Respuesta</span></tt><a class="headerlink" href="#transmitiendo-una-respuesta" title="Enlazar permanentemente con este título">¶</a></h3>
<p class="versionadded">
<span class="versionmodified">Nuevo en la versión 2.1: </span>La compatibilidad a la transmisión de respuestas se añadió en <em>Symfony 2.1</em>.</p>
<p>La clase <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\StreamedResponse</span></tt> te permite transmitir la respuesta de vuelta al cliente. El contenido de la respuesta está representado por una función <em>PHP</em> ejecutable en lugar de una cadena:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\StreamedResponse</span><span class="p">;</span>

<span class="nv">$response</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">StreamedResponse</span><span class="p">();</span>
<span class="nv">$response</span><span class="o">-&gt;</span><span class="na">setCallback</span><span class="p">(</span><span class="k">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s1">&#39;Hello World&#39;</span><span class="p">;</span>
    <span class="nb">flush</span><span class="p">();</span>
    <span class="nb">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
    <span class="k">echo</span> <span class="s1">&#39;Hello World&#39;</span><span class="p">;</span>
    <span class="nb">flush</span><span class="p">();</span>
<span class="p">});</span>
<span class="nv">$response</span><span class="o">-&gt;</span><span class="na">send</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="descargando-archivos">
<h3>Descargando archivos<a class="headerlink" href="#descargando-archivos" title="Enlazar permanentemente con este título">¶</a></h3>
<p class="versionadded">
<span class="versionmodified">Nuevo en la versión 2.1: </span>El método <tt class="docutils literal"><span class="pre">makeDisposition</span></tt> fue añadido en <em>Symfony 2.1</em>.</p>
<p>Al cargar un archivo, debes agregar una cabecera <tt class="docutils literal"><span class="pre">Content-Disposition</span></tt> a tu respuesta. Es fácil crear esta cabecera básica para descargar archivos, utilizando nombres de archivo
no <em>ASCII</em> más envolventes. El método <tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/:Symfony/Component/HttpFoundation/Response:makeDispositio.html#Symfony\Component\HttpFoundation\Response:makeDisposition()" title=":Symfony\Component\HttpFoundation\Response:makeDispositio::Symfony\Component\HttpFoundation\Response:makeDisposition()"><span class="pre">Symfony\Component\HttpFoundation\Response:makeDisposition()</span></a></tt> abstrae el trabajo duro detrás de una sencilla <em>API</em>:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\ResponseHeaderBag</span><span class="p">;</span>

<span class="nv">$d</span> <span class="o">=</span> <span class="nv">$response</span><span class="o">-&gt;</span><span class="na">headers</span><span class="o">-&gt;</span><span class="na">makeDisposition</span><span class="p">(</span><span class="nx">ResponseHeaderBag</span><span class="o">::</span><span class="na">DISPOSITION_ATTACHMENT</span><span class="p">,</span> <span class="s1">&#39;foo.pdf&#39;</span><span class="p">);</span>

<span class="nv">$response</span><span class="o">-&gt;</span><span class="na">headers</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;Content-Disposition&#39;</span><span class="p">,</span> <span class="nv">$d</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="sesiones">
<h2>Sesiones<a class="headerlink" href="#sesiones" title="Enlazar permanentemente con este título">¶</a></h2>
<p>El componente <tt class="docutils literal"><span class="pre">HttpFoundation</span></tt> de <em>Symfony2</em> tiene un subsistema de sesión muy potente y flexible, que está diseñado para proporcionar la gestión de sesiones a través de una sencilla interfaz orientada a objetos, utilizando una variedad de controladores para el almacenamiento de la sesión.</p>
<p class="versionadded">
<span class="versionmodified">Nuevo en la versión 2.1: </span>La interfaz <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Session\SessionInterface</span></tt>, así como una serie de otros cambios, son nuevas a partir de <em>Symfony 2.1</em>.</p>
<p>Las sesiones se utilizan a través de la simple clase <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Session\Session</span></tt> que implementa la interfaz <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Session\SessionInterface</span></tt>.</p>
<p>Ejemplo rápido:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\Session\Session</span><span class="p">;</span>

<span class="nv">$session</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Session</span><span class="p">();</span>
<span class="nv">$session</span><span class="o">-&gt;</span><span class="na">start</span><span class="p">();</span>

<span class="c1">// establece y obtiene atributos de sesión</span>
<span class="nv">$session</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;Drak&#39;</span><span class="p">);</span>
<span class="nv">$session</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">);</span>

<span class="c1">// configura mensajes flash</span>
<span class="nv">$session</span><span class="o">-&gt;</span><span class="na">getFlashBag</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;notice&#39;</span><span class="p">,</span> <span class="s1">&#39;Profile updated&#39;</span><span class="p">);</span>

<span class="c1">// recupera mensajes</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$session</span><span class="o">-&gt;</span><span class="na">getFlashBag</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;notice&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">())</span> <span class="k">as</span> <span class="nv">$message</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s2">&quot;&lt;div class=&#39;flash-notice&#39;&gt;</span><span class="si">$message</span><span class="s2">&lt;/div&gt;&quot;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="section" id="api-de-sesion">
<h3><em>API</em> de sesión<a class="headerlink" href="#api-de-sesion" title="Enlazar permanentemente con este título">¶</a></h3>
<p>La clase <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Session\Session</span></tt> implementa la interfaz <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Session\SessionInterface</span></tt>.</p>
<p>La clase <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Session\Session</span></tt> tiene una <em>API</em> sencilla subdividida en un par de grupos.</p>
<p>Flujo de trabajo en la sesión</p>
<ul class="simple">
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/Session.html#start()" title="Symfony\Component\HttpFoundation\Session\Session::start()"><span class="pre">start()</span></a></tt>:
Inicia la sesión &#8212; no usa <tt class="docutils literal"><span class="pre">session_start()</span></tt>.</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/Session.html#migrate()" title="Symfony\Component\HttpFoundation\Session\Session::migrate()"><span class="pre">migrate()</span></a></tt>:
Regenera el <tt class="docutils literal"><span class="pre">id</span></tt> de la sesión &#8212; no usa <tt class="docutils literal"><span class="pre">session_regenerate_id()</span></tt>.
Este método opcionalmente puede cambiar el tiempo de vida de la nueva <tt class="docutils literal"><span class="pre">cookie</span></tt> que se emite al llamar a este método.</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/Session.html#invalidate()" title="Symfony\Component\HttpFoundation\Session\Session::invalidate()"><span class="pre">invalidate()</span></a></tt>:
Vacía los datos de la sesión y regenera el <tt class="docutils literal"><span class="pre">id</span></tt> de sesión sin usar <tt class="docutils literal"><span class="pre">session_destroy()</span></tt>.
Este básicamente es un atajo para <tt class="docutils literal"><span class="pre">clear()</span></tt> y <tt class="docutils literal"><span class="pre">migrate()</span></tt>.</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/Session.html#getId()" title="Symfony\Component\HttpFoundation\Session\Session::getId()"><span class="pre">getId()</span></a></tt>: Recupera el <tt class="docutils literal"><span class="pre">id</span></tt> de la sesión.</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/Session.html#setId()" title="Symfony\Component\HttpFoundation\Session\Session::setId()"><span class="pre">setId()</span></a></tt>: Establece el <tt class="docutils literal"><span class="pre">id</span></tt> de la sesión.</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/Session.html#getName()" title="Symfony\Component\HttpFoundation\Session\Session::getName()"><span class="pre">getName()</span></a></tt>: Recupera el nombre de la sesión.</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/Session.html#setName()" title="Symfony\Component\HttpFoundation\Session\Session::setName()"><span class="pre">setName()</span></a></tt>: Establece el nombre de la sesión.</li>
</ul>
<p>Atributos de la sesión</p>
<ul class="simple">
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/Session.html#set()" title="Symfony\Component\HttpFoundation\Session\Session::set()"><span class="pre">set()</span></a></tt>:
Establece un atributo por su clave;</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/Session.html#get()" title="Symfony\Component\HttpFoundation\Session\Session::get()"><span class="pre">get()</span></a></tt>:
Recupera un atributo por su clave;</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/Session.html#all()" title="Symfony\Component\HttpFoundation\Session\Session::all()"><span class="pre">all()</span></a></tt>:
Recupera todos los atributos como una matriz de <tt class="docutils literal"><span class="pre">clave</span> <span class="pre">=&gt;</span> <span class="pre">valor</span></tt>;</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/Session.html#has()" title="Symfony\Component\HttpFoundation\Session\Session::has()"><span class="pre">has()</span></a></tt>:
Devuelve <tt class="docutils literal"><span class="pre">true</span></tt> si el atributo existe;</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/Session.html#keys()" title="Symfony\Component\HttpFoundation\Session\Session::keys()"><span class="pre">keys()</span></a></tt>:
Devuelve un arreglo de claves de atributo guardadas;</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/Session.html#replace()" title="Symfony\Component\HttpFoundation\Session\Session::replace()"><span class="pre">replace()</span></a></tt>:
Establece múltiples atributos simultáneamente: toma una matriz indexada y configura cada pareja <tt class="docutils literal"><span class="pre">clave</span> <span class="pre">=&gt;</span> <span class="pre">valor</span></tt>.</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/Session.html#remove()" title="Symfony\Component\HttpFoundation\Session\Session::remove()"><span class="pre">remove()</span></a></tt>:
Elimina un atributo por clave;</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/Session.html#clear()" title="Symfony\Component\HttpFoundation\Session\Session::clear()"><span class="pre">clear()</span></a></tt>:
Limpia todos los atributos;</li>
</ul>
<p>Internamente los atributos se almacenan en una <tt class="docutils literal"><span class="pre">&quot;Bag&quot;</span></tt> (&#8216;Bolsa&#8217;, en adelante), un objeto <em>PHP</em> que actúa como un arreglo. Unos cuantos métodos existentes para gestionar una <tt class="docutils literal"><span class="pre">&quot;Bolsa&quot;</span></tt>:</p>
<ul class="simple">
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/Session.html#registerBag()" title="Symfony\Component\HttpFoundation\Session\Session::registerBag()"><span class="pre">registerBag()</span></a></tt>:
Registra una <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Session\SessionBagInterface</span></tt></li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/Session.html#getBag()" title="Symfony\Component\HttpFoundation\Session\Session::getBag()"><span class="pre">getBag()</span></a></tt>:
Consigue una <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Session\SessionBagInterface</span></tt> por medio del nombre de la &#8220;Bolsa&#8221;.</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/Session.html#getFlashBag()" title="Symfony\Component\HttpFoundation\Session\Session::getFlashBag()"><span class="pre">getFlashBag()</span></a></tt>:
Recupera la <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Session\Flash\FlashBagInterface</span></tt>.
Esta, únicamente es un conveniente atajo.</li>
</ul>
<p>Metadatos de sesión</p>
<ul class="simple">
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/Session.html#getMetadataBag()" title="Symfony\Component\HttpFoundation\Session\Session::getMetadataBag()"><span class="pre">getMetadataBag()</span></a></tt>:
Obtiene la clase <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Session\StorageMetadataBag</span></tt> la cual contiene información de la sesión.</li>
</ul>
</div>
<div class="section" id="controladores-de-guardado">
<h3>Controladores de guardado<a class="headerlink" href="#controladores-de-guardado" title="Enlazar permanentemente con este título">¶</a></h3>
<p>El flujo de trabajo en la sesión <em>PHP</em> tiene 6 posibles operaciones que pueden ocurrir.  El flujo de sesión normal sigue el proceso de <tt class="docutils literal"><span class="pre">apertura</span></tt>, <tt class="docutils literal"><span class="pre">lectura</span></tt>, <tt class="docutils literal"><span class="pre">escritura</span></tt> y  <tt class="docutils literal"><span class="pre">cierre</span></tt>, con la posibilidad de <tt class="docutils literal"><span class="pre">destrucción</span></tt> y <tt class="docutils literal"><span class="pre">gc</span></tt> (por <tt class="docutils literal"><span class="pre">garbage</span> <span class="pre">collection</span></tt> o recolección de basura, la cual cerrará todas las sesiones abiertas: la <cite>gc</cite> se invoca aleatoriamente de acuerdo a la configuración de <em>PHP</em> y si es llamada directamente, su invocación se difiere hasta después de una operación de <tt class="docutils literal"><span class="pre">apertura</span></tt>).  Puedes leer más sobre esto en <a class="reference external" href="http://www.php.net/manual/es/session.customhandler.php">php.net/session.customhandler</a></p>
</div>
<div class="section" id="controladores-de-guardado-nativos-de-php">
<h3>Controladores de guardado nativos de <em>PHP</em><a class="headerlink" href="#controladores-de-guardado-nativos-de-php" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Los llamados controladores &#8216;nativos&#8217;, son los manipuladores de sesión que son o bien compilados dentro de <em>PHP</em> o proporcionados por extensiones <em>PHP</em>, como <em>PHP SQLite</em>, <em>PHP-Memcached</em>, etc.
Los manipuladores se compilan y se pueden activar directamente en <em>PHP</em> usando <tt class="docutils literal"><span class="pre">ini_set('session.save_handler',</span> <span class="pre">$nombre);</span></tt> y se suelen configurar con <tt class="docutils literal"><span class="pre">ini_set('session.save_path',</span> <span class="pre">$ruta);</span></tt> y, a veces, una variedad de otras directivas <tt class="docutils literal"><span class="pre">ini</span></tt> de <em>PHP</em>.</p>
<p><em>Symfony2</em> proporciona controladores para manipuladores nativos que son fáciles de configurar, estos son:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Session\Storage\Handler\NativeFileSessionHandler</span></tt>;</li>
<li><tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Session\Storage\Handler\NativeSqliteSessionHandler</span></tt>;</li>
<li><tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Session\Storage\Handler\NativeMemcacheSessionHandler</span></tt>;</li>
<li><tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Session\Storage\Handler\NativeMemcachedSessionHandler</span></tt>;</li>
<li><tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Session\Storage\Handler\NativeRedisSessionHandler</span></tt>;</li>
</ul>
</div></blockquote>
<p>Ejemplo de uso:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\Session\Session</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\Session\Storage\NativeSessionStorage</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\Session\Storage\Handler\NativeMemcachedSessionHandler</span><span class="p">;</span>

<span class="nv">$storage</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">NativeSessionStorage</span><span class="p">(</span><span class="k">array</span><span class="p">(),</span> <span class="k">new</span> <span class="nx">NativeMemcachedSessionHandler</span><span class="p">());</span>
<span class="nv">$session</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Session</span><span class="p">(</span><span class="nv">$storage</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="controladores-de-guardado-personalizados">
<h3>Controladores de guardado personalizados<a class="headerlink" href="#controladores-de-guardado-personalizados" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Los manipuladores personalizados son aquellos que sustituyen por completo a los controladores de guardado de sesión integrados en <em>PHP</em>, proveyendo seis funciones retrollamadas que <em>PHP</em> invoca internamente en varios puntos en el flujo de trabajo de la sesión.</p>
<p><em>HttpFoundation</em> de <em>Symfony2</em>, por omisión, ofrece algunos de estos y fácilmente te pueden servir como
ejemplos, si quieres escribir uno propio.</p>
<blockquote>
<div><ul class="simple">
<li><tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Session\Storage\Handler\PdoSessionHandler</span></tt>;</li>
<li><tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Session\Storage\Handler\MemcacheSessionHandler</span></tt>;</li>
<li><tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Session\Storage\Handler\MemcachedSessionHandler</span></tt>;</li>
<li><tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Session\Storage\Handler\NullSessionHandler</span></tt>;</li>
</ul>
</div></blockquote>
<p>Ejemplo:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\Session\Session</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\Session\Storage\SessionStorage</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\Session\Storage\Handler\PdoSessionHandler</span><span class="p">;</span>

<span class="nv">$storage</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">NativeSessionStorage</span><span class="p">(</span><span class="k">array</span><span class="p">(),</span> <span class="k">new</span> <span class="nx">PdoSessionHandler</span><span class="p">());</span>
<span class="nv">$session</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Session</span><span class="p">(</span><span class="nv">$storage</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="bolsas-de-sesion">
<h2>Bolsas de sesión<a class="headerlink" href="#bolsas-de-sesion" title="Enlazar permanentemente con este título">¶</a></h2>
<p>La gestión de sesiones <em>PHP</em> requiere el uso de la superglobal <tt class="docutils literal"><span class="pre">$_SESSION</span></tt>, sin embargo, esto interfiere un poco con la comprobabilidad y encapsulación de código en un paradigma de programación orientado a objetos. Para ayudar a superar esta situación, <em>Symfony2</em> usa &#8216;bolsas de sesión&#8217; vinculadas a la sesión para encapsular un conjunto de datos específico a los &#8216;atributos&#8217; o &#8216;mensajes flash&#8217;.</p>
<p>Este enfoque también reduce la contaminación del espacio de nombres dentro de la superglobal <tt class="docutils literal"><span class="pre">$_SESSION</span></tt>, porque cada bolsa almacena todos sus datos bajo un único espacio de nombres.
Esto le permite a <em>Symfony2</em> coexistir pacíficamente con otras aplicaciones o bibliotecas que puedan usar la superglobal <tt class="docutils literal"><span class="pre">$_SESSION</span></tt> y todos los datos siguen siendo totalmente compatibles con la gestión de sesiones de <em>Symfony2</em>.</p>
<p><em>Symfony2</em> ofrece 2 tipos de bolsas, con dos implementaciones independientes.
Todo está escrito contra interfaces para que las puedas ampliar o crear tus propios tipos de bolsa si es necesario.</p>
<p><tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Session\SessionBagInterface</span></tt> tiene la siguiente <em>API</em> destinada principalmente para uso interno:</p>
<ul class="simple">
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/SessionBagInterface.html#getStorageKey()" title="Symfony\Component\HttpFoundation\Session\SessionBagInterface::getStorageKey()"><span class="pre">getStorageKey()</span></a></tt>:
Devuelve la clave, que en última instancia es la bolsa que va a almacenar su arreglo bajo <tt class="docutils literal"><span class="pre">$_SESSION</span></tt>.
En general, puedes dejar este valor en su predefinido y es para uso interno.</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/SessionBagInterface.html#initialize()" title="Symfony\Component\HttpFoundation\Session\SessionBagInterface::initialize()"><span class="pre">initialize()</span></a></tt>:
<em>Symfony2</em> llama internamente a este método para almacenar clases de sesión con datos para vincularlos a la bolsa de la sesión.</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/SessionBagInterface.html#getName()" title="Symfony\Component\HttpFoundation\Session\SessionBagInterface::getName()"><span class="pre">getName()</span></a></tt>:
Devuelve el nombre de la bolsa de sesión.</li>
</ul>
<div class="section" id="atributos">
<h3><tt class="docutils literal"><span class="pre">Atributos</span></tt><a class="headerlink" href="#atributos" title="Enlazar permanentemente con este título">¶</a></h3>
<p>El propósito de la implementación de la <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Session\Attribute\AttributeBagInterface</span></tt> de bolsas, es manejar el almacenamiento de los atributos de la sesión. Esto puede incluir cosas como el <tt class="docutils literal"><span class="pre">id</span></tt> de usuario, y la funcionalidad &#8220;recuérdame&#8221; en la configuración del inicio de sesión u otra información basada en el estado del usuario.</p>
<ul class="simple">
<li><tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Session\Attribute\AttributeBag</span></tt> Esta es la implementación estándar predeterminada.</li>
<li><tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Session\Attribute\NamespacedAttributeBag</span></tt> Esta implementación permite que los atributos sean almacenados en un espacio de nombres estructurado.</li>
</ul>
<p>Cualquier sistema de almacenamiento sencillo <tt class="docutils literal"><span class="pre">clave</span> <span class="pre">=&gt;</span> <span class="pre">valor</span></tt> está limitado en la medida en que se puedan almacenar datos complejos, ya que cada clave debe ser única. Lo puedes lograr introduciendo una convención a la nomenclatura de los espacios de nombres para que las claves sean partes diferentes de tu aplicación lo cual podría funcionar sin colisiones. Por ejemplo, <tt class="docutils literal"><span class="pre">modulo1.foo</span></tt> y <tt class="docutils literal"><span class="pre">modulo2.foo</span></tt>. Sin embargo, a veces esto no es muy práctico cuando los datos de los atributos están en una matriz, por ejemplo, un conjunto de iniciales. En este caso, la gestión de la matriz se convierte en una carga porque hay que recuperar la matriz, luego, procesarla y almacenarla de nuevo:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$tokens</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;tokens&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;a&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;a6c1e0b6&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;b&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;f4a7b1f3&#39;</span><span class="p">));</span>
</pre></div>
</div>
<p>Así que cualquier procesamiento de este tipo rápidamente se puede poner feo, aunque sólo añadas un elemento a la matriz:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$tokens</span> <span class="o">=</span> <span class="nv">$session</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;tokens&#39;</span><span class="p">);</span>
<span class="nv">$tokens</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$value</span><span class="p">;</span>
<span class="nv">$session</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;tokens&#39;</span><span class="p">,</span> <span class="nv">$tokens</span><span class="p">);</span>
</pre></div>
</div>
<p>Con el espacio de nombre estructurado, la clave se puede traducir a la estructura de la matriz tal cual usando un carácter del espacio de nombres (por omisión es <tt class="docutils literal"><span class="pre">/</span></tt>):</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$session</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;tokens/c&#39;</span><span class="p">,</span> <span class="nv">$value</span><span class="p">);</span>
</pre></div>
</div>
<p>De esta manera puedes acceder a una clave dentro de la matriz almacenada directa y fácilmente.</p>
<p>La <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Session\Attribute\AttributeBagInterface</span></tt> cuenta con una <em>API</em> sencilla</p>
<ul class="simple">
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/Attribute/AttributeBagInterface.html#set()" title="Symfony\Component\HttpFoundation\Session\Attribute\AttributeBagInterface::set()"><span class="pre">set()</span></a></tt>:
Establece un atributo por su clave;</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/Attribute/AttributeBagInterface.html#get()" title="Symfony\Component\HttpFoundation\Session\Attribute\AttributeBagInterface::get()"><span class="pre">get()</span></a></tt>:
Recupera un atributo por su clave;</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/Attribute/AttributeBagInterface.html#all()" title="Symfony\Component\HttpFoundation\Session\Attribute\AttributeBagInterface::all()"><span class="pre">all()</span></a></tt>:
Recupera todos los atributos como una matriz de <tt class="docutils literal"><span class="pre">clave</span> <span class="pre">=&gt;</span> <span class="pre">valor</span></tt>;</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/Attribute/AttributeBagInterface.html#has()" title="Symfony\Component\HttpFoundation\Session\Attribute\AttributeBagInterface::has()"><span class="pre">has()</span></a></tt>:
Devuelve <tt class="docutils literal"><span class="pre">true</span></tt> si el atributo existe;</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/Attribute/AttributeBagInterface.html#keys()" title="Symfony\Component\HttpFoundation\Session\Attribute\AttributeBagInterface::keys()"><span class="pre">keys()</span></a></tt>:
Devuelve un arreglo de claves de atributo guardadas;</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/Attribute/AttributeBagInterface.html#replace()" title="Symfony\Component\HttpFoundation\Session\Attribute\AttributeBagInterface::replace()"><span class="pre">replace()</span></a></tt>:
Establece múltiples atributos simultáneamente: toma una matriz indexada y configura cada pareja <tt class="docutils literal"><span class="pre">clave</span> <span class="pre">=&gt;</span> <span class="pre">valor</span></tt>.</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/Attribute/AttributeBagInterface.html#remove()" title="Symfony\Component\HttpFoundation\Session\Attribute\AttributeBagInterface::remove()"><span class="pre">remove()</span></a></tt>:
Elimina un atributo por clave;</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/Attribute/AttributeBagInterface.html#clear()" title="Symfony\Component\HttpFoundation\Session\Attribute\AttributeBagInterface::clear()"><span class="pre">clear()</span></a></tt>:
Vacía la bolsa;</li>
</ul>
</div>
<div class="section" id="mensajes-flash">
<h3>Mensajes flash<a class="headerlink" href="#mensajes-flash" title="Enlazar permanentemente con este título">¶</a></h3>
<p>El propósito de la <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Session\Flash\FlashBagInterface</span></tt> es proporcionar una forma de configurar y recuperar mensajes basándose en la sesión.
El flujo de trabajo habitual de los mensajes flash se encuentra en una <tt class="docutils literal"><span class="pre">Petición</span></tt>, y se muestran después de redirigir a una página. Por ejemplo, un usuario envía un formulario que llegará a un controlador de actualización, y después de procesar el controlador redirige al usuario o bien a la página actualizada o a una página de error. Los mensajes flash establecidos en la <tt class="docutils literal"><span class="pre">petición</span></tt> de página anterior se muestran inmediatamente al cargar la siguiente página en esa sesión.
Esta, sin embargo, sólo es una aplicación para los mensajes flash.</p>
<ul class="simple">
<li><tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Session\Flash\AutoExpireFlashBag</span></tt> Esta implementación de mensajes se ajusta al cargar la página para que esté disponible para visualizarlo al cargar la siguiente página. Estos mensajes expirarán automáticamente independientemente de si se recuperan o no.</li>
<li><tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Session\Flash\FlashBag</span></tt> En esta implementación, los mensajes se mantendrán en la sesión hasta que se recuperen o borren explícitamente. Esto hace posible el uso de la caché <em>ESI</em>.</li>
</ul>
<p>La <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Session\Flash\FlashBagInterface</span></tt> tiene una sencilla <em>API</em></p>
<ul class="simple">
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/Flash/FlashBagInterface.html#add()" title="Symfony\Component\HttpFoundation\Session\Flash\FlashBagInterface::add()"><span class="pre">add()</span></a></tt>:
Añade un mensaje flash a la pila del tipo especificado;</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/Flash/FlashBagInterface.html#set()" title="Symfony\Component\HttpFoundation\Session\Flash\FlashBagInterface::set()"><span class="pre">set()</span></a></tt>:
Configura mensajes flash por tipo;  Este método toma ambos, mensajes como una <tt class="docutils literal"><span class="pre">cadena</span></tt> o varios mensajes en una <tt class="docutils literal"><span class="pre">matriz</span></tt>.</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/Flash/FlashBagInterface.html#get()" title="Symfony\Component\HttpFoundation\Session\Flash\FlashBagInterface::get()"><span class="pre">get()</span></a></tt>:
Recupera mensajes por tipo y los quita de la bolsa;</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/Flash/FlashBagInterface.html#setAll()" title="Symfony\Component\HttpFoundation\Session\Flash\FlashBagInterface::setAll()"><span class="pre">setAll()</span></a></tt>:
Establece todos los flashes, acepta una matriz de matrices indexada <tt class="docutils literal"><span class="pre">tipo</span> <span class="pre">=&gt;</span> <span class="pre">array(mensajes)</span></tt>;</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/Flash/FlashBagInterface.html#all()" title="Symfony\Component\HttpFoundation\Session\Flash\FlashBagInterface::all()"><span class="pre">all()</span></a></tt>:
Recupera todos los mensajes flash (en forma de matriz de matrices indexadas) y quita los mensajes de la bolsa;</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/Flash/FlashBagInterface.html#peek()" title="Symfony\Component\HttpFoundation\Session\Flash\FlashBagInterface::peek()"><span class="pre">peek()</span></a></tt>:
Recupera mensajes flash por tipo (sólo lectura);</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/Flash/FlashBagInterface.html#peekAll()" title="Symfony\Component\HttpFoundation\Session\Flash\FlashBagInterface::peekAll()"><span class="pre">peekAll()</span></a></tt>:
Recupera todos los mensajes flash (sólo lectura) como matriz de matrices indexadas;</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/Flash/FlashBagInterface.html#has()" title="Symfony\Component\HttpFoundation\Session\Flash\FlashBagInterface::has()"><span class="pre">has()</span></a></tt>:
Devuelve <tt class="docutils literal"><span class="pre">true</span></tt> si el tipo existe, <tt class="docutils literal"><span class="pre">false</span></tt> en caso contrario;</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/Flash/FlashBagInterface.html#keys()" title="Symfony\Component\HttpFoundation\Session\Flash\FlashBagInterface::keys()"><span class="pre">keys()</span></a></tt>:
Devuelve un arreglo de tipos flash guardados;</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/Flash/FlashBagInterface.html#clear()" title="Symfony\Component\HttpFoundation\Session\Flash\FlashBagInterface::clear()"><span class="pre">clear()</span></a></tt>:
Limpia la bolsa;</li>
</ul>
<p>Para aplicaciones simples por lo general es suficiente tener un mensaje flash por tipo, por ejemplo, un aviso de confirmación después de enviar un formulario. Sin embargo, los mensajes Flash se almacenan en una matriz indexada por el <tt class="docutils literal"><span class="pre">$tipo</span></tt> del flash, lo cual significa que tu aplicación puede emitir varios mensajes de un determinado tipo. Esto te permite utilizar la <em>API</em> para mensajes más complejos en tu aplicación.</p>
<p>Ejemplos de configuración de múltiples mensajes flash:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\Session\Session</span><span class="p">;</span>

<span class="nv">$session</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Session</span><span class="p">();</span>
<span class="nv">$session</span><span class="o">-&gt;</span><span class="na">start</span><span class="p">();</span>

<span class="c1">// añade mensajes flash</span>
<span class="nv">$session</span><span class="o">-&gt;</span><span class="na">getFlashBag</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;warning&#39;</span><span class="p">,</span> <span class="s1">&#39;Your config file is writable, it should be set read-only&#39;</span><span class="p">);</span>
<span class="nv">$session</span><span class="o">-&gt;</span><span class="na">getFlashBag</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="s1">&#39;Failed to update name&#39;</span><span class="p">);</span>
<span class="nv">$session</span><span class="o">-&gt;</span><span class="na">getFlashBag</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">add</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="s1">&#39;Another error&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>Para exhibir los mensajes flash puedes usar algo como esto:</p>
<p>Simple, muestra un tipo de mensaje:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// muestra advertencias</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$session</span><span class="o">-&gt;</span><span class="na">getFlashBag</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;warning&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">())</span> <span class="k">as</span> <span class="nv">$message</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s2">&quot;&lt;div class=&#39;flash-warning&#39;&gt;</span><span class="si">$message</span><span class="s2">&lt;/div&gt;&quot;</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// muestra errores</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$session</span><span class="o">-&gt;</span><span class="na">getFlashBag</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">())</span> <span class="k">as</span> <span class="nv">$message</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s2">&quot;&lt;div class=&#39;flash-error&#39;&gt;</span><span class="si">$message</span><span class="s2">&lt;/div&gt;&quot;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Método compacto para procesar la exhibición simultánea de todos los mensajes:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">foreach</span> <span class="p">(</span><span class="nv">$session</span><span class="o">-&gt;</span><span class="na">getFlashBag</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">all</span><span class="p">()</span> <span class="k">as</span> <span class="nv">$type</span> <span class="o">=&gt;</span> <span class="nv">$messages</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$messages</span> <span class="k">as</span> <span class="nv">$message</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">&quot;&lt;div class=&#39;flash-</span><span class="si">$type</span><span class="s2">&#39;&gt;</span><span class="si">$message</span><span class="s2">&lt;/div&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="comprobabilidad">
<h2>Comprobabilidad<a class="headerlink" href="#comprobabilidad" title="Enlazar permanentemente con este título">¶</a></h2>
<p><em>Symfony2</em> se diseñó desde el principio con la comprobabilidad de código en mente. Con el fin de hacer que el código que utiliza la sesión sea fácilmente comprobable, disponemos de dos mecanismos de almacenamiento independientes para simular ambas, pruebas unitarias y pruebas funcionales.</p>
<p>Probar el código usando sesiones reales es difícil porque el estado del flujo de trabajo de <em>PHP</em> es global y no es posible tener varias sesiones simultáneas en el mismo proceso <em>PHP</em>.</p>
<p>Los motores de almacenamiento fingido simulan el flujo de trabajo de las sesiones <em>PHP</em> sin tener que iniciar una, lo cual te permite probar tu código sin complicaciones. También es posible ejecutar varias instancias en el mismo proceso <em>PHP</em>.</p>
<p>Los controladores de almacenamiento simulado no leen ni escriben las globales del sistema <tt class="docutils literal"><span class="pre">session_id()</span></tt> o <tt class="docutils literal"><span class="pre">session_name()</span></tt>. Y proporcionan métodos para simularlas de ser necesario:</p>
<ul class="simple">
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/SessionStorageInterface.html#getId()" title="Symfony\Component\HttpFoundation\Session\SessionStorageInterface::getId()"><span class="pre">getId()</span></a></tt>: Recupera el <tt class="docutils literal"><span class="pre">id</span></tt> de la sesión.</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/SessionStorageInterface.html#setId()" title="Symfony\Component\HttpFoundation\Session\SessionStorageInterface::setId()"><span class="pre">setId()</span></a></tt>: Establece el <tt class="docutils literal"><span class="pre">id</span></tt> de la sesión.</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/SessionStorageInterface.html#getName()" title="Symfony\Component\HttpFoundation\Session\SessionStorageInterface::getName()"><span class="pre">getName()</span></a></tt>: Recupera el nombre de la sesión.</li>
<li><tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/SessionStorageInterface.html#setName()" title="Symfony\Component\HttpFoundation\Session\SessionStorageInterface::setName()"><span class="pre">setName()</span></a></tt>: Establece el nombre de la sesión.</li>
</ul>
<div class="section" id="pruebas-unitarias">
<h3>Pruebas unitarias<a class="headerlink" href="#pruebas-unitarias" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Para las pruebas unitarias donde no es necesario persistir la sesión, simplemente debes intercambiar el motor de almacenamiento predefinido con <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Session\Storage\MockArraySessionStorage</span></tt>:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\Session\Storage\MockArraySessionStorage</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\Session\Session</span><span class="p">;</span>

<span class="nv">$session</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Session</span><span class="p">(</span><span class="k">new</span> <span class="nx">MockArraySessionStorage</span><span class="p">());</span>
</pre></div>
</div>
</div>
<div class="section" id="pruebas-funcionales">
<h3>Pruebas funcionales<a class="headerlink" href="#pruebas-funcionales" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Para las pruebas funcionales donde posiblemente necesites conservar los datos de sesión a través de procesos <em>PHP</em> independientes, basta con cambiar el motor de almacenamiento a la clase <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Session\Storage\MockFileSessionStorage</span></tt>:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\Session\Session</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\HttpFoundation\Session\Storage\MockFileSessionStorage</span><span class="p">;</span>

<span class="nv">$session</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Session</span><span class="p">(</span><span class="k">new</span> <span class="nx">MockFileSessionStorage</span><span class="p">());</span>
</pre></div>
</div>
</div>
<div class="section" id="compatibilidad-con-php-5-4">
<h3>Compatibilidad con <em>PHP 5.4</em><a class="headerlink" href="#compatibilidad-con-php-5-4" title="Enlazar permanentemente con este título">¶</a></h3>
<p>A partir de <em>PHP 5.4.0</em>, están disponibles <tt class="docutils literal"><a class="reference external" href="http://php.net/manual/en/class.sessionhandler.php" title="SessionHandler"><span class="pre">SessionHandler</span></a></tt> y <tt class="docutils literal"><a class="reference external" href="http://php.net/manual/en/class.sessionhandlerinterface.php" title="SessionHandlerInterface"><span class="pre">SessionHandlerInterface</span></a></tt>. <em>Symfony 2.1</em> proporciona compatibilidad para <tt class="docutils literal"><a class="reference external" href="http://php.net/manual/en/class.sessionhandlerinterface.php" title="SessionHandlerInterface"><span class="pre">SessionHandlerInterface</span></a></tt> por lo tanto la puedes utilizar en <em>PHP 5.3</em>. Esto, gratamente mejora la interoperabilidad con otras bibliotecas.</p>
<p><tt class="docutils literal"><a class="reference external" href="http://php.net/manual/en/class.sessionhandler.php" title="SessionHandler"><span class="pre">SessionHandler</span></a></tt> es una clase interna especial de <em>PHP</em> que expone los controladores de guardado nativos para el espacio de usuario de <em>PHP</em>.</p>
<p>Con el fin de proporcionar una solución para aquellos que utilizan <em>PHP 5.4</em>, <em>Symfony2</em> tiene una clase especial llamada <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Session\Storage\Handler\NativeSessionHandler</span></tt> que bajo <em>PHP 5.4</em>, se extiende desde <cite>SessionHandler</cite> y bajo <em>PHP 5.3</em> es sólo una clase base vacía. Esto proporciona interesantes oportunidades para aprovechar la funcionalidad de <em>PHP 5.4</em> si está disponible.</p>
</div>
<div class="section" id="controladores-delegados-de-guardado">
<h3>Controladores delegados de guardado<a class="headerlink" href="#controladores-delegados-de-guardado" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Hay dos tipos de controladores delegados de clases de guardado que heredan de <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Session\Storage\Handler\AbstractProxy</span></tt>:
estas son <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Session\Storage\Handler\NativeProxy</span></tt> y <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Session\Storage\Handler\SessionHandlerProxy</span></tt>.</p>
<p>La <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Session\Storage\NativeSessionStorage</span></tt> automáticamente inyecta los controladores de guardado en un controlador de guardado delegado, a menos que ya lo envuelva uno.</p>
<p>La clase <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Session\Storage\Handler\NativeProxy</span></tt> se utiliza automáticamente en <em>PHP 5.3</em>, cuando los controladores de guardado internos de <em>PHP</em> se especifican usando las clases <tt class="docutils literal"><span class="pre">Native*SessionHandler</span></tt>, mientras que la clase <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Session\Storage\Handler\SessionHandlerProxy</span></tt> se utiliza para envolver cualquier controlador de guardado personalizado, esta implementa la <tt class="docutils literal"><a class="reference external" href="http://php.net/manual/en/class.sessionhandlerinterface.php" title="SessionHandlerInterface"><span class="pre">SessionHandlerInterface</span></a></tt>.</p>
<p>En <em>PHP 5.4</em> y superior, todos los controladores de sesión implementan la <tt class="docutils literal"><a class="reference external" href="http://php.net/manual/en/class.sessionhandlerinterface.php" title="SessionHandlerInterface"><span class="pre">SessionHandlerInterface</span></a></tt> incluyendo las clases <tt class="docutils literal"><span class="pre">Native*SessionHandler</span></tt> que heredan de <tt class="docutils literal"><a class="reference external" href="http://php.net/manual/en/class.sessionhandler.php" title="SessionHandler"><span class="pre">SessionHandler</span></a></tt>.</p>
<p>El mecanismo delegado te permite involucrarte profundamente en las clases controladoras del guardado de sesiones. Podrías utilizar un delegado, por ejemplo, para cifrar cualquier transacción de la sesión sin el conocimiento específico del controlador de guardado.</p>
</div>
<div class="section" id="configurando-sesiones-php">
<h3>Configurando sesiones <em>PHP</em><a class="headerlink" href="#configurando-sesiones-php" title="Enlazar permanentemente con este título">¶</a></h3>
<p>La clase <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Session\Storage\NativeSessionStorage</span></tt> puede ajustar la mayoría de las directivas de configuración de <em>PHP</em>, las cuales están documentadas en <a class="reference external" href="http://dk2.php.net/session.configuration">php.net/session.configuration</a>.</p>
<p>Para configurar estos opciones, pasa las claves (omitiendo la primera parte <tt class="docutils literal"><span class="pre">session.</span></tt> de la clave) como una matriz de clave/valor como el argumento <tt class="docutils literal"><span class="pre">$options</span></tt> del constructor.
O ajústalas a través del método <tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/Storage/NativeSessionStorage.html#setOptions()" title="Symfony\Component\HttpFoundation\Session\Storage\NativeSessionStorage::setOptions()"><span class="pre">setOptions()</span></a></tt>.</p>
<p>En aras de la claridad, algunas de las opciones principales se explican en esta documentación.</p>
</div>
<div class="section" id="duracion-de-la-cookie-de-sesion">
<h3>Duración de la <tt class="docutils literal"><span class="pre">cookie</span></tt> de sesión<a class="headerlink" href="#duracion-de-la-cookie-de-sesion" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Para mayor seguridad, generalmente se recomienda enviar fragmentos de sesión como <tt class="docutils literal"><span class="pre">cookies</span></tt> de sesión.
Puedes configurar el tiempo de vida de las <tt class="docutils literal"><span class="pre">cookies</span></tt> de sesión, especificando la duración (en segundos) usando la clave <tt class="docutils literal"><span class="pre">cookie_lifetime</span></tt> en el argumento <tt class="docutils literal"><span class="pre">$options</span></tt> del constructor en <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Session\Storage\NativeSessionStorage</span></tt>.</p>
<p>Establecer una <tt class="docutils literal"><span class="pre">cookie_lifetime</span></tt> a <tt class="docutils literal"><span class="pre">0</span></tt> provocará que la <tt class="docutils literal"><span class="pre">cookie</span></tt> viva sólo mientras el navegador sigue abierto. En general, <tt class="docutils literal"><span class="pre">cookie_lifetime</span></tt> se establece en un número de días, semanas o meses relativamente grande. No es raro dejar <tt class="docutils literal"><span class="pre">cookies</span></tt> durante un año o más, dependiendo de la aplicación.</p>
<p>Dado que las <tt class="docutils literal"><span class="pre">cookies</span></tt> de sesión son sólo una muestra del lado del cliente, estas son menos importantes al controlar los detalles de la configuración de seguridad que en última instancia sólo se pueden controlar en el lado del servidor.</p>
<div class="admonition note">
<p class="first admonition-title">Nota</p>
<p class="last">La opción <tt class="docutils literal"><span class="pre">cookie_lifetime</span></tt> es el número de segundos que la <tt class="docutils literal"><span class="pre">cookie</span></tt> debería vivir, esta no es una marca de tiempo Unix. La <tt class="docutils literal"><span class="pre">cookie</span></tt> de sesión resultante será sellada durante un plazo de <tt class="docutils literal"><span class="pre">time()</span></tt> + <tt class="docutils literal"><span class="pre">cookie_lifetime</span></tt> donde el tiempo se toma desde el servidor.</p>
</div>
</div>
<div class="section" id="configurando-la-recoleccion-de-basura">
<h3>Configurando la recolección de basura<a class="headerlink" href="#configurando-la-recoleccion-de-basura" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Cuando se abre una sesión, <em>PHP</em> llama aleatoriamente al controlador <tt class="docutils literal"><span class="pre">gc</span></tt> de acuerdo a la probabilidad establecida por <tt class="docutils literal"><span class="pre">session.gc_probability</span></tt> / <tt class="docutils literal"><span class="pre">session.gc_divisor</span></tt>. Por ejemplo, si éstos se establecieron en <tt class="docutils literal"><span class="pre">5/100</span></tt>, respectivamente, significaría una probabilidad del 5%. Del mismo modo, <tt class="docutils literal"><span class="pre">3/4</span></tt> significaría invocarlo en 3 de cada 4 oportunidades, es decir, un 75%.</p>
<p>Si se invoca el controlador de la recolección de basura, <em>PHP</em> pasará el valor almacenado en la directiva <tt class="docutils literal"><span class="pre">ini</span></tt> <tt class="docutils literal"><span class="pre">session.gc_maxlifetime</span></tt> de <em>PHP</em>. El significado en este contexto es que cualquier sesión almacenada que se guardó más de <tt class="docutils literal"><span class="pre">maxlifetime</span></tt> se debería suprimir. Esto le permite a uno expirar los registros basándose en el tiempo de inactividad.</p>
<p>Puedes configurar estas opciones pasando <tt class="docutils literal"><span class="pre">gc_probability</span></tt>, <tt class="docutils literal"><span class="pre">gc_divisor</span></tt> y <tt class="docutils literal"><span class="pre">gc_maxlifetime</span></tt> en una matriz al constructor de <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Session\Storage\NativeSessionStorage</span></tt> o al método <tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/Storage/NativeSessionStorage.html#setOptions()()" title="Symfony\Component\HttpFoundation\Session\Storage\NativeSessionStorage::setOptions()()"><span class="pre">setOptions()()</span></a></tt>.</p>
</div>
<div class="section" id="tiempo-de-vida-de-la-sesion">
<h3>Tiempo de vida de la sesión<a class="headerlink" href="#tiempo-de-vida-de-la-sesion" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Cuando se crea una nueva sesión, significa que <em>Symfony2</em> emite una nueva <tt class="docutils literal"><span class="pre">cookie</span></tt> de sesión para el cliente, la <tt class="docutils literal"><span class="pre">cookie</span></tt> será sellada con un tiempo de caducidad. Este se calcula sumando el valor de configuración de <tt class="docutils literal"><span class="pre">session.cookie_lifetime</span></tt> en <em>PHP</em> con la hora actual del servidor.</p>
<div class="admonition note">
<p class="first admonition-title">Nota</p>
<p><em>PHP</em> sólo emitirá una <tt class="docutils literal"><span class="pre">cookie</span></tt> una vez. Se espera que el cliente guarde esa <tt class="docutils literal"><span class="pre">cookie</span></tt> toda la vida. Sólo se otorgará una nueva <tt class="docutils literal"><span class="pre">cookie</span></tt> cuando la sesión sea destruida, se elimine la <tt class="docutils literal"><span class="pre">cookie</span></tt> en el navegador, o se vuelva a regenerar el identificador de sesión usando los métodos <tt class="docutils literal"><span class="pre">migrate()</span></tt> o <tt class="docutils literal"><span class="pre">invalidate()</span></tt> de la clase <tt class="docutils literal"><span class="pre">Session</span></tt>.</p>
<p class="last">La duración inicial de la <tt class="docutils literal"><span class="pre">cookie</span></tt> se puede establecer configurando <tt class="docutils literal"><span class="pre">NativeSessionStorage</span></tt> utilizando el método <tt class="docutils literal"><span class="pre">setOptions(array('cookie_lifetime'</span> <span class="pre">=&gt;</span> <span class="pre">1234))</span></tt>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Nota</p>
<p class="last">Una duración de <tt class="docutils literal"><span class="pre">0</span></tt> en la <tt class="docutils literal"><span class="pre">cookie</span></tt> significa que la <tt class="docutils literal"><span class="pre">cookie</span></tt> expira al cerrar el navegador.</p>
</div>
</div>
<div class="section" id="tiempo-de-inactividad-mantener-viva-la-sesion">
<h3>Tiempo de inactividad/Mantener viva la sesión<a class="headerlink" href="#tiempo-de-inactividad-mantener-viva-la-sesion" title="Enlazar permanentemente con este título">¶</a></h3>
<p>A menudo hay circunstancias en las que posiblemente quieras proteger, o reducir al mínimo el uso no autorizado de una sesión cuando un usuario se retira de su terminal mientras está conectado destruyendo la sesión después de cierto período de tiempo de inactividad. Por ejemplo, es común que las aplicaciones de banca cierren la sesión después de sólo 5 a 10 minutos de inactividad. Ajustar la duración de la <tt class="docutils literal"><span class="pre">cookie</span></tt> aquí no es apropiado debido a que el cliente la puede manipular, por lo que debemos hacer la expiración de lado del servidor. La forma más fácil es implementarla a través de la recolección de basura la cual se ejecuta con razonable frecuencia. El <tt class="docutils literal"><span class="pre">lifetime</span></tt> de la <tt class="docutils literal"><span class="pre">cookie</span></tt> se establece a un valor relativamente alto, y la recolección de basura <tt class="docutils literal"><span class="pre">maxlifetime</span></tt> se establecería para destruir sesiones en cualquiera que sea el período de inactividad deseado.</p>
<p>La otra opción es comprobar específicamente si una sesión ha caducado después de haber iniciado la sesión. La sesión se puede destruir si es necesario. Este método de procesamiento puede permitir la integración de la expiración de sesiones en la experiencia del usuario, por ejemplo, visualizando un mensaje.</p>
<p><em>Symfony2</em> registra algunos metadatos básicos acerca de cada sesión para darte completa libertad en este ámbito.</p>
</div>
<div class="section" id="metadatos-de-sesion">
<h3>Metadatos de sesión<a class="headerlink" href="#metadatos-de-sesion" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Las sesiones están decoradas con un poco de metadatos básicos para permitirte un control preciso sobre la configuración de seguridad. El objeto <tt class="docutils literal"><span class="pre">Sesión</span></tt> tiene un captador de metadatos, <tt class="docutils literal"><a class="reference external" href="http://api.symfony.com/master/Symfony/Component/HttpFoundation/Session/Session.html#getMetadataBag()" title="Symfony\Component\HttpFoundation\Session\Session::getMetadataBag()"><span class="pre">getMetadataBag()</span></a></tt> que
expone una instancia de <tt class="xref php php-class docutils literal"><span class="pre">Symfony\Component\HttpFoundation\Session\Storage\MetadataBag</span></tt>:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$session</span><span class="o">-&gt;</span><span class="na">getMetadataBag</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getCreated</span><span class="p">();</span>
<span class="nv">$session</span><span class="o">-&gt;</span><span class="na">getMetadataBag</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getLastUsed</span><span class="p">();</span>
</pre></div>
</div>
<p>Ambos métodos devuelven una marca de tiempo Unix (relativa al servidor).</p>
<p>Puedes utilizar estos metadatos para expirar la sesión explícitamente en el acceso, por ejemplo:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$session</span><span class="o">-&gt;</span><span class="na">start</span><span class="p">();</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">time</span><span class="p">()</span> <span class="o">-</span> <span class="nv">$session</span><span class="o">-&gt;</span><span class="na">getMetadataBag</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getLastUpdate</span><span class="p">()</span> <span class="o">&gt;</span> <span class="nv">$maxIdleTime</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$session</span><span class="o">-&gt;</span><span class="na">invalidate</span><span class="p">();</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nx">SessionExpired</span><span class="p">();</span> <span class="c1">// redirige a la página de sesión expirada</span>
<span class="p">}</span>
</pre></div>
</div>
<p>También es posible decir cuál es el <tt class="docutils literal"><span class="pre">cookie_lifetime</span></tt> establecido en una <tt class="docutils literal"><span class="pre">cookie</span></tt> en particular leyendo el método <tt class="docutils literal"><span class="pre">getLifetime()</span></tt>:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$session</span><span class="o">-&gt;</span><span class="na">getMetadataBag</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getLifetime</span><span class="p">();</span>
</pre></div>
</div>
<p>Puedes determinar el tiempo de caducidad de la <tt class="docutils literal"><span class="pre">cookie</span></tt> sumando la fecha y hora de creación y el <tt class="docutils literal"><span class="pre">lifetime</span></tt>.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  <a href="https://github.com/symfony/symfony-standard"><img style="position: fixed; top: 0; right: 0; border: 0;" src="http://gitnacho.github.com/tnp/img/comun/bifurcame.png" alt="Bifúrcame en GitHub" /></a>
  
  <div style="width:740px;margin:10px auto;">
    
    <div class="related">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Índice General"
             >índice</a></li>
        <li><a href="../index.html">en Español</a> &raquo;</li> 
      </ul>
    </div>
  </div>


   <div style="width: 740px; margin: 0 auto;">
     <div id="disqus_thread"></div>
     
    <div class="footer">
        &copy; Copyright 2011-2012, Traducido por Nacho Pacheco.
      Actualizado por última vez en May 21, 2012.
      Creado con <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.2.
    </div>
   </div>
   <script type="text/javascript">
    var disqus_shortname = 'documentos-mx';
    var disqus_developer = 1;
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
   </script>
   <noscript>
     Por favor activa JavaScript para ver los <a href="http://disqus.com/?ref_noscript">comentarios accionados por Disqus.</a>
   </noscript>

  </body>
</html>