
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>JMSSecurityExtraBundle &mdash; Manual de Symfony2 en Español</title>
    
    <link rel="stylesheet" href="../../_static/tnp.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '2.0.12',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/translations.js"></script>
    <link rel="shortcut icon" href="../../_static/icotnp.ico"/>
    <link rel="top" title="Manual de Symfony2 en Español" href="../../index.html" />
    <link rel="up" title="Paquetes de la edición estándar de Symfony" href="../index.html" />
    <link rel="next" title="DoctrineFixturesBundle" href="../DoctrineFixturesBundle/index.html" />
    <link rel="prev" title="JMSDiExtraBundle" href="../JMSDiExtraBundle/index.html" /> 
  </head>
  <body>
  <div class="imalogo">
    
  <a href="../../index.html"><img src="http://gitnacho.github.com/tnp/img/sf/logo-big.gif" alt="Edición estándar de Symfony2" />
  
    <a href="http://gitnacho.github.com/tnp/"><img src="http://gitnacho.github.com/tnp/_static/normaltnp.png" alt="Traducciones de Nacho Pacheco" /></a>
    <div class="social">
      <a href="https://twitter.com/share" class="twitter-share-button" data-via="esymfony" data-lang="es">Tweet</a>
      <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
    </div>
    <div id="searchbox">
      <form class="searc " action="../../search.html" method="get">
      <input type="search" name="q" placeholder="Término a buscar" />
      <input type="submit" value="Ir" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <script type="text/javascript">$('#searchbox').show(0);</script>
    </div>
    

    
    <div class="related">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="Índice General"
             accesskey="I">índice</a></li>
        <li class="right" >
          <a href="../DoctrineFixturesBundle/index.html" title="DoctrineFixturesBundle"
             accesskey="N">siguiente</a> |</li>
        <li class="right" >
          <a href="../JMSDiExtraBundle/index.html" title="JMSDiExtraBundle"
             accesskey="P">anterior</a> |</li>
        <li><a href="../../index.html">en Español</a> &raquo;</li>
          <li><a href="../index.html" accesskey="U">Paquetes de la edición estándar de <em>Symfony</em></a> &raquo;</li> 
      </ul>
    </div>
  </div>


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="jmssecurityextrabundle">
<h1><tt class="docutils literal"><span class="pre">JMSSecurityExtraBundle</span></tt><a class="headerlink" href="#jmssecurityextrabundle" title="Enlazar permanentemente con este título">¶</a></h1>
<p>Este paquete mejora el componente <tt class="docutils literal"><span class="pre">Security</span></tt> de <em>Symfony2</em> añadiendo nuevas características.</p>
<p>Características:</p>
<ul class="simple">
<li>Potente lenguaje de autorización basado en expresiones</li>
<li>Método de seguridad para autorización</li>
<li>Configuración de autorización vía anotaciones</li>
</ul>
<div class="section" id="instalando">
<h2>Instalando<a class="headerlink" href="#instalando" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Añade lo siguiente a tu archivo <tt class="docutils literal"><span class="pre">deps</span></tt>:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>JMSSecurityExtraBundle<span class="o">]</span>
    <span class="nv">git</span><span class="o">=</span>https://github.com/schmittjoh/JMSSecurityExtraBundle.git
    <span class="nv">target</span><span class="o">=</span>/bundles/JMS/SecurityExtraBundle

; Dependencias:
;--------------
<span class="o">[</span>metadata<span class="o">]</span>
    <span class="nv">git</span><span class="o">=</span>https://github.com/schmittjoh/metadata.git
    <span class="nv">version</span><span class="o">=</span>1.1.0 ; &lt;- asegúrate de conseguir 1.1, no 1.0

; ve https://github.com/schmittjoh/JMSAopBundle/blob/master/Resources/doc/index.rst
<span class="o">[</span>JMSAopBundle<span class="o">]</span>
    <span class="nv">git</span><span class="o">=</span>https://github.com/schmittjoh/JMSAopBundle.git
    <span class="nv">target</span><span class="o">=</span>/bundles/JMS/AopBundle

<span class="o">[</span>cg-library<span class="o">]</span>
    <span class="nv">git</span><span class="o">=</span>https://github.com/schmittjoh/cg-library.git

; Esta dependencia es opcional <span class="o">(</span>la necesitas si no estás usando
; servicios como controladores<span class="o">)</span>:
; ve https://github.com/schmittjoh/JMSDiExtraBundle/blob/master/Resources/doc/index.rst
<span class="o">[</span>JMSDiExtraBundle<span class="o">]</span>
    <span class="nv">git</span><span class="o">=</span>https://github.com/schmittjoh/JMSDiExtraBundle.git
    <span class="nv">target</span><span class="o">=</span>/bundles/JMS/DiExtraBundle
</pre></div>
</div>
<p>Finalmente, registra el paquete en tu núcleo:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// en AppKernel::registerBundles()</span>
<span class="nv">$bundles</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="c1">// ...</span>
    <span class="k">new</span> <span class="nx">JMS\AopBundle\JMSAopBundle</span><span class="p">(),</span>
    <span class="k">new</span> <span class="nx">JMS\SecurityExtraBundle\JMSSecurityExtraBundle</span><span class="p">(),</span>
    <span class="k">new</span> <span class="nx">JMS\DiExtraBundle\JMSDiExtraBundle</span><span class="p">(</span><span class="nv">$this</span><span class="p">),</span>
    <span class="c1">// ...</span>
<span class="p">);</span>
</pre></div>
</div>
<p>Asegúrate de registrar los espacios de nombres en tu cargador automático:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// app/autoload.php</span>
<span class="nv">$loader</span><span class="o">-&gt;</span><span class="na">registerNamespaces</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="c1">// ...</span>
    <span class="s1">&#39;JMS&#39;</span>              <span class="o">=&gt;</span> <span class="nx">__DIR__</span><span class="o">.</span><span class="s1">&#39;/../vendor/bundles&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Metadata&#39;</span>         <span class="o">=&gt;</span> <span class="nx">__DIR__</span><span class="o">.</span><span class="s1">&#39;/../vendor/metadata/src&#39;</span><span class="p">,</span>
    <span class="s1">&#39;CG&#39;</span>               <span class="o">=&gt;</span> <span class="nx">__DIR__</span><span class="o">.</span><span class="s1">&#39;/../vendor/cg-library/src&#39;</span><span class="p">,</span>
    <span class="c1">// ...</span>
<span class="p">));</span>
</pre></div>
</div>
</div>
<div class="section" id="configurando">
<h2>Configurando<a class="headerlink" href="#configurando" title="Enlazar permanentemente con este título">¶</a></h2>
<p>La siguiente es la configuración predeterminada:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># app/config/config.yml</span>
<span class="l-Scalar-Plain">jms_security_extra</span><span class="p-Indicator">:</span>
    <span class="c1"># Cuando desees asegurar todos los servicios (true), o proteger</span>
    <span class="c1"># únicamente servicios específicos (false); ve más adelante</span>
    <span class="l-Scalar-Plain">secure_all_services</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">false</span>

    <span class="c1"># Al habilitar esta opción adicionalmente añadirá un atributo</span>
    <span class="c1"># especial &quot;IS_IDDQD&quot;. Cualquiera con este atributo efectivamente</span>
    <span class="c1"># evadirá todas las comprobaciones de seguridad.</span>
    <span class="l-Scalar-Plain">enable_iddqd_attribute</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">false</span>

    <span class="c1"># Habilita el lenguaje de expresiones</span>
    <span class="l-Scalar-Plain">expressions</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">false</span>

    <span class="c1"># Te permite inhabilitar algunos, o todos los votantes integrados</span>
    <span class="l-Scalar-Plain">voters</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">disable_authenticated</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">false</span>
        <span class="l-Scalar-Plain">disable_role</span><span class="p-Indicator">:</span>          <span class="l-Scalar-Plain">false</span>
        <span class="l-Scalar-Plain">disable_acl</span><span class="p-Indicator">:</span>           <span class="l-Scalar-Plain">false</span>

    <span class="c1"># Te permite especificar reglas de control de acceso para métodos</span>
    <span class="c1"># específicos, tal como los controladores de acción</span>
    <span class="l-Scalar-Plain">method_access_control</span><span class="p-Indicator">:</span> <span class="p-Indicator">{</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
</div>
<div class="section" id="lenguaje-de-autorizacion-basado-en-expresiones">
<h2>Lenguaje de autorización basado en expresiones<a class="headerlink" href="#lenguaje-de-autorizacion-basado-en-expresiones" title="Enlazar permanentemente con este título">¶</a></h2>
<p>El lenguaje de expresiones es una muy potente alternativa para los simples atributos de los votantes del sistema de seguridad. Te permiten tomar decisiones complejas para controlar el acceso, y debido a que está compilado hasta <em>PHP</em> crudo, son mucho más rápidos que los votantes integrados. Además, nativamente se cargan de manera diferida, por lo tanto también debes asegurar algunos recursos, por ejemplo, al no tener que iniciar el sistema <em>ACL</em> completo en cada petición.</p>
<div class="section" id="uso-programado">
<h3>Uso programado<a class="headerlink" href="#uso-programado" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Puedes ejecutar expresiones programadas utilizando el método <tt class="docutils literal"><span class="pre">isGranted</span></tt> del <tt class="docutils literal"><span class="pre">SecurityContext</span></tt>. Algunos ejemplos:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">use</span> <span class="nx">JMS\SecurityExtraBundle\Security\Authorization\Expression\Expression</span><span class="p">;</span>

<span class="nv">$securityContext</span><span class="o">-&gt;</span><span class="na">isGranted</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="k">new</span> <span class="nx">Expression</span><span class="p">(</span><span class="s1">&#39;hasRole(&quot;A&quot;)&#39;</span><span class="p">)));</span>
<span class="nv">$securityContext</span><span class="o">-&gt;</span><span class="na">isGranted</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="k">new</span> <span class="nx">Expression</span><span class="p">(</span><span class="s1">&#39;hasRole(&quot;A&quot;) or (hasRole(&quot;B&quot;) and hasRole(&quot;C&quot;))&#39;</span><span class="p">)));</span>
<span class="nv">$securityContext</span><span class="o">-&gt;</span><span class="na">isGranted</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="k">new</span> <span class="nx">Expression</span><span class="p">(</span><span class="s1">&#39;hasPermission(object, &quot;VIEW&quot;)&#39;</span><span class="p">),</span> <span class="nv">$object</span><span class="p">));</span>
<span class="nv">$securityContext</span><span class="o">-&gt;</span><span class="na">isGranted</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="k">new</span> <span class="nx">Expression</span><span class="p">(</span><span class="s1">&#39;token.getUsername() == &quot;Johannes&quot;&#39;</span><span class="p">)));</span>
</pre></div>
</div>
</div>
<div class="section" id="usando-twig">
<h3>Usando <em>Twig</em><a class="headerlink" href="#usando-twig" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Puedes comprobar expresiones desde plantillas <em>Twig</em> utilizando la función <tt class="docutils literal"><span class="pre">is_expr_granted</span></tt>. Algunos ejemplos:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nx">is_expr_granted</span><span class="p">(</span><span class="s2">&quot;hasRole(&#39;FOO&#39;)&quot;</span><span class="p">)</span>
<span class="nx">is_expr_granted</span><span class="p">(</span><span class="s2">&quot;hasPermission(object, &#39;VIEW&#39;)&quot;</span><span class="p">,</span> <span class="nx">object</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="usando-el-control-de-acceso">
<h3>Usando el control de acceso<a class="headerlink" href="#usando-el-control-de-acceso" title="Enlazar permanentemente con este título">¶</a></h3>
<p>También puedes usar expresiones en <tt class="docutils literal"><span class="pre">access_control</span></tt>:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">security</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">access_control</span><span class="p-Indicator">:</span>
        <span class="p-Indicator">-</span> <span class="p-Indicator">{</span> <span class="nv">path</span><span class="p-Indicator">:</span> <span class="nv">^/foo</span><span class="p-Indicator">,</span> <span class="nv">access</span><span class="p-Indicator">:</span> <span class="s">&quot;hasRole(&#39;FOO&#39;)</span><span class="nv"> </span><span class="s">and</span><span class="nv"> </span><span class="s">hasRole(&#39;BAR&#39;)&quot;</span> <span class="p-Indicator">}</span>
</pre></div>
</div>
</div>
<div class="section" id="usando-en-base-a-anotaciones">
<h3>Usando en base a anotaciones<a class="headerlink" href="#usando-en-base-a-anotaciones" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Consulta la anotación <tt class="docutils literal"><span class="pre">&#64;PreAuthorize</span></tt> en la <a class="reference internal" href="#referencia">referencia</a></p>
</div>
<div class="section" id="referencia">
<h3>Referencia<a class="headerlink" href="#referencia" title="Enlazar permanentemente con este título">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="38%" />
<col width="62%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Expresión</th>
<th class="head">Descripción</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>hasRole(&#8216;ROLE&#8217;)</td>
<td>comprueba si el segmento tiene un determinado rol.</td>
</tr>
<tr class="row-odd"><td>hasAnyRole(&#8216;ROLE1&#8217;, &#8216;ROLE2&#8217;, ...)</td>
<td>Comprueba si el segmento tiene alguno de los roles
proporcionados.</td>
</tr>
<tr class="row-even"><td>isAnonymous()</td>
<td>Comprueba si el segmento es anónimo.</td>
</tr>
<tr class="row-odd"><td>isRememberMe()</td>
<td>Comprueba si el segmento es del tipo &#8220;Recuérdame&#8221;.</td>
</tr>
<tr class="row-even"><td>isFullyAuthenticated()</td>
<td>Comprueba si el segmento está completamente
autenticado.</td>
</tr>
<tr class="row-odd"><td>isAuthenticated()</td>
<td>Comprueba si el segmento no es anónimo.</td>
</tr>
<tr class="row-even"><td>hasPermission(var, &#8216;PERMISSION&#8217;)</td>
<td>Comprueba si el segmento tiene los permisos
proporcionados para un objeto dado (necesita el
sistema  <em>ACL</em>).</td>
</tr>
<tr class="row-odd"><td>token</td>
<td>Variable que permite el acceso al segmento que se
encuentra actualmente en el contexto de seguridad.</td>
</tr>
<tr class="row-even"><td>user</td>
<td>Variable que permite el acceso al usuario que está
actualmente en el contexto de seguridad.</td>
</tr>
<tr class="row-odd"><td>object</td>
<td>Variable que hace referencia al objeto para el cual se
solicita acceso.</td>
</tr>
<tr class="row-even"><td>#*paramName*</td>
<td>Cualquier identificador prefijado con # se refiere a
un parámetro del mismo nombre pasado al método donde
se usa la expresión</td>
</tr>
<tr class="row-odd"><td>and / &amp;&amp;</td>
<td>El operador binario &#8220;and&#8221;</td>
</tr>
<tr class="row-even"><td>or / ||</td>
<td>El operador binario &#8220;or&#8221;</td>
</tr>
<tr class="row-odd"><td>==</td>
<td>El operador binario &#8220;is equal&#8221;</td>
</tr>
<tr class="row-even"><td>not / !</td>
<td>Operador de negación</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="autorizacion-de-seguridad-para-metodos">
<h2>Autorización de seguridad para métodos<a class="headerlink" href="#autorizacion-de-seguridad-para-metodos" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Generalmente, puedes asegurar todos los métodos públicos, o métodos protegidos que no son estáticos, ni finales. Los métodos privados no se pueden asegurar. También puedes añadir metadatos para métodos abstractos, o interfaces que entonces serán aplicados automáticamente a sus implementaciones concretas.</p>
<div class="section" id="control-de-acceso-via-configuracion-di">
<h3>Control de acceso vía configuración <tt class="docutils literal"><span class="pre">DI</span></tt><a class="headerlink" href="#control-de-acceso-via-configuracion-di" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Puedes especificar <strong>expresiones</strong> para el control de acceso en la configuración <tt class="docutils literal"><span class="pre">DI</span></tt>:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># config.yml</span>
<span class="l-Scalar-Plain">jms_security_extra</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">method_access_control</span><span class="p-Indicator">:</span>
        <span class="s">&#39;:loginAction$&#39;</span><span class="p-Indicator">:</span> <span class="s">&#39;isAnonymous()&#39;</span>
        <span class="s">&#39;AcmeFooBundle:.*:deleteAction&#39;</span><span class="p-Indicator">:</span> <span class="s">&#39;hasRole(&quot;ROLE_ADMIN&quot;)&#39;</span>
        <span class="s">&#39;^MyNamespace\MyService::foo$&#39;</span><span class="p-Indicator">:</span> <span class="s">&#39;hasPermission(#user,</span><span class="nv"> </span><span class="s">&quot;VIEW&quot;)&#39;</span>
</pre></div>
</div>
<p>El patrón es una expresión regular que distingue entre mayúsculas y minúsculas emparejada contra dos notaciones.
Se utiliza la primer coincidencia.</p>
<p>En primer lugar, tu patrón se compara con la notación de controladores que no son servicios.
Obviamente, esto sólo se hace si tu clase en realidad es un controlador, por ejemplo, <tt class="docutils literal"><span class="pre">AcmeFooBundle:Add:new</span></tt> para un controlador llamado <tt class="docutils literal"><span class="pre">AddController</span></tt> y un método denominado <tt class="docutils literal"><span class="pre">NewAction</span></tt> en un subespacio de nombres <tt class="docutils literal"><span class="pre">Controller</span></tt> de un paquete llamado <tt class="docutils literal"><span class="pre">AcmeFooBundle</span></tt>.</p>
<p>Por último, tu patrón se empareja contra la concatenación del nombre de clase, y el nombre del método que está invocando, por ejemplo, <tt class="docutils literal"><span class="pre">Mi\Completamente\Cualificado\NombreClase::miNombreMetodo</span></tt>.</p>
<div class="admonition note">
<p class="first admonition-title">Nota</p>
<p class="last">Si quisieras asegurar controladores que no son servicios, en su lugar deberías usar el <tt class="docutils literal"><span class="pre">JMSDiExtraBundle</span></tt>.</p>
</div>
</div>
<div class="section" id="control-de-acceso-via-anotaciones">
<h3>Control de acceso vía anotaciones<a class="headerlink" href="#control-de-acceso-via-anotaciones" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Si quisieras asegurar un servicio con <tt class="docutils literal"><span class="pre">anotaciones</span></tt>, necesitas habilitar la configuración de <tt class="docutils literal"><span class="pre">annotation</span></tt> para ese servicio:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;service</span> <span class="na">id=</span><span class="s">&quot;foo&quot;</span> <span class="na">class=</span><span class="s">&quot;Bar&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;tag</span> <span class="na">name=</span><span class="s">&quot;security.secure_service&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/service&gt;</span>
</pre></div>
</div>
<p>En caso, que quieras configurar todos los  servicios vía <tt class="docutils literal"><span class="pre">anotaciones</span></tt>, también puedes poner <tt class="docutils literal"><span class="pre">secure_all_services</span></tt> a <tt class="docutils literal"><span class="pre">true</span></tt>. Entonces, no necesitas añadir una etiqueta a cada servicio.</p>
</div>
</div>
<div class="section" id="anotaciones">
<h2>Anotaciones<a class="headerlink" href="#anotaciones" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="section" id="preauthorize">
<h3><tt class="docutils literal"><span class="pre">&#64;PreAuthorize</span></tt><a class="headerlink" href="#preauthorize" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Esta anotación te permite definir una expresión (ve el párrafo del lenguaje de expresiones) que se ejecutó anteriormente a la invocación de un método:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">use</span> <span class="nx">JMS\SecurityExtraBundle\Annotation\PreAuthorize</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">MyService</span>
<span class="p">{</span>
    <span class="sd">/** @PreAuthorize(&quot;hasRole(&#39;A&#39;) or (hasRole(&#39;B&#39;) and hasRole(&#39;C&#39;))&quot;) */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">secureMethod</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="secure">
<h3><tt class="docutils literal"><span class="pre">&#64;Secure</span></tt><a class="headerlink" href="#secure" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Esta anotación te permite definir quién está autorizado a invocar un método:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">use</span> <span class="nx">JMS\SecurityExtraBundle\Annotation\Secure</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">MyService</span>
<span class="p">{</span>
    <span class="sd">/**</span>
<span class="sd">     * @Secure(roles=&quot;ROLE_USER, ROLE_FOO, ROLE_ADMIN&quot;)</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">secureMethod</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="secureparam">
<h3><tt class="docutils literal"><span class="pre">&#64;SecureParam</span></tt><a class="headerlink" href="#secureparam" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Esta anotación te permite definir restricciones para los parámetros que se le pasan al método. Esto sólo es útil si los parámetros son objetos del dominio:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">use</span> <span class="nx">JMS\SecurityExtraBundle\Annotation\SecureParam</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">MyService</span>
<span class="p">{</span>
    <span class="sd">/**</span>
<span class="sd">     * @SecureParam(name=&quot;comment&quot;, permissions=&quot;EDIT, DELETE&quot;)</span>
<span class="sd">     * @SecureParam(name=&quot;post&quot;, permissions=&quot;OWNER&quot;)</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">secureMethod</span><span class="p">(</span><span class="nv">$comment</span><span class="p">,</span> <span class="nv">$post</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="securereturn">
<h3><tt class="docutils literal"><span class="pre">&#64;SecureReturn</span></tt><a class="headerlink" href="#securereturn" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Esta anotación te permite definir restricciones para el valor que devuelve el método. Esto también es útil sólo si el valor devuelto es un objeto del dominio:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">use</span> <span class="nx">JMS\SecurityExtraBundle\Annotation\SecureReturn</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">MyService</span>
<span class="p">{</span>
    <span class="sd">/**</span>
<span class="sd">     * @SecureReturn(permissions=&quot;VIEW&quot;)</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">secureMethod</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// ...</span>

        <span class="k">return</span> <span class="nv">$domainObject</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="runas">
<h3><tt class="docutils literal"><span class="pre">&#64;RunAs</span></tt><a class="headerlink" href="#runas" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Esta anotación te permite especificar los roles que se añadirán sólo mientras subsista la invocación del método. Estos roles no serán tomados en consideración antes o después de las decisiones de acceso a la invocación.</p>
<p>Esto se suele utilizar para implementar una capa de dos niveles para el servicio, donde tienes servicios públicos y privados, y los servicios privados únicamente son invocados a través de un servicio público específico:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">use</span> <span class="nx">JMS\SecurityExtraBundle\Annotation\Secure</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">JMS\SecurityExtraBundle\Annotation\RunAs</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">MyPrivateService</span>
<span class="p">{</span>
    <span class="sd">/**</span>
<span class="sd">     * @Secure(roles=&quot;ROLE_PRIVATE_SERVICE&quot;)</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">aMethodOnlyToBeInvokedThroughASpecificChannel</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">MyPublicService</span>
<span class="p">{</span>
    <span class="k">protected</span> <span class="nv">$myPrivateService</span><span class="p">;</span>

    <span class="sd">/**</span>
<span class="sd">     * @Secure(roles=&quot;ROLE_USER&quot;)</span>
<span class="sd">     * @RunAs(roles=&quot;ROLE_PRIVATE_SERVICE&quot;)</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">canBeInvokedFromOtherServices</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">myPrivateService</span><span class="o">-&gt;</span><span class="na">aMethodOnlyToBeInvokedThroughASpecificChannel</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="satisfiesparentsecuritypolicy">
<h3><tt class="docutils literal"><span class="pre">&#64;SatisfiesParentSecurityPolicy</span></tt><a class="headerlink" href="#satisfiesparentsecuritypolicy" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Esto lo debes definir en un método que sustituya al método que tiene metadatos de seguridad.
Está ahí para asegurarse de que estás consciente de que la seguridad del método reemplazado no se puede hacer valer más, y que tienes que copiar todas las anotaciones si deseas mantenerlas.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  <a href="https://github.com/symfony/symfony-standard"><img style="position: fixed; top: 0; right: 0; border: 0;" src="http://gitnacho.github.com/tnp/img/comun/bifurcame.png" alt="Bifúrcame en GitHub" /></a>
  
  <div style="width:740px;margin:10px auto;">
    
    <div class="related">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="Índice General"
             >índice</a></li>
        <li class="right" >
          <a href="../DoctrineFixturesBundle/index.html" title="DoctrineFixturesBundle"
             >siguiente</a> |</li>
        <li class="right" >
          <a href="../JMSDiExtraBundle/index.html" title="JMSDiExtraBundle"
             >anterior</a> |</li>
        <li><a href="../../index.html">en Español</a> &raquo;</li>
          <li><a href="../index.html" >Paquetes de la edición estándar de <em>Symfony</em></a> &raquo;</li> 
      </ul>
    </div>
  </div>


   <div style="width: 740px; margin: 0 auto;">
     <div id="disqus_thread"></div>
     
    <div class="footer">
        &copy; Copyright 2011-2012, Traducido por Nacho Pacheco.
      Actualizado por última vez en Apr 28, 2012.
      Creado con <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.2.
    </div>
   </div>
   <script type="text/javascript">
    var disqus_shortname = 'documentos-mx';
    var disqus_developer = 1;
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
   </script>
   <noscript>
     Por favor activa JavaScript para ver los <a href="http://disqus.com/?ref_noscript">comentarios accionados por Disqus.</a>
   </noscript>

  </body>
</html>